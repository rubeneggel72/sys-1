<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="/../img/apple-icon.png">
  <link rel="icon" type="image/png" href="../img/favicon.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
  <title>
    SYS EC-EDITAR NOTA DE VENTA
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
  <!-- Nucleo Icons -->
  <link href="../css/nucleo-icons.css" rel="stylesheet" />
  <link href="../css/nucleo-svg.css" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <link href="../css/nucleo-svg.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link id="pagestyle" href="/../css/soft-ui-dashboard.css?v=1.0.7" rel="stylesheet" />
  <!-- Nepcha Analytics (nepcha.com) -->
  <!-- Nepcha is a easy-to-use web analytics. No cookies and fully compliant with GDPR, CCPA and PECR. -->
  <!-- nepcha script  -->
</head>

<body class="g-sidenav-show  bg-gray-100">
  <%- include ('../partials/_sideNavBar.ejs') %>
    <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
      <!-- Navbar -->
      <%- include ('../partials/_navBar.ejs') %>
        <!-- End Navbar -->

        <form action="<%= notaventa._id %>?_method=PUT" method="POST">
          <div class="form-group mb-4">
            <button type="submit" class="btn btn-primary">Guardar</button>
            <a href="/notaventa/index" class="btn btn-info" role="button">Cancelar cambios</a>
            <!-- <button type="button" class="btn btn-danger" data-bs-toggle="modal" id="deleteButton"
                data-bs-target="#deleteModal">Eliminar</button> -->
          </div>
          <div class="row my-4">
            <div class="col-lg-12 col-md-12 mb-md-0 mb-4">
              <div class="card">
                <div class="card-header pb-0">
                  <div class="row">
                    <div class="row form-group mb-4">
                    </div>
                  </div>
                </div>
                <div id="datos">
                  <div class="row form-group mb-4">
                    <input  hidden type="text"  id="tipousuario" value="<%= user.role %>">
                    <input hidden type="text" name="string08" id="string08">
                    <input hidden type="text" class="form-control" id="notaventa_id" 
                    value="<%= notaventa._id %>" placeholder="">
                    <input hidden type="text" class="form-control" id="fecha"  value="<%= fecha %>" placeholder="">
                    <input hidden type="text" class="form-control" id="short"   value="<%= user.short %>" placeholder="">
                    <input hidden type="text" class="form-control" id="_id" name="_idorganizacion"
                      value="<%= notaventa._idorganizacion %>" placeholder="">
                    <input hidden type="text" class="form-control" id="string02" name="string02"
                      value="<%= notaventa.string02 %>" placeholder="">
                    <input hidden type="text" class="form-control" id="string03" name="string03"
                      value="<%= notaventa.string03 %>" placeholder="">
                    <input hidden type="text" class="form-control" name="idorganizacion"
                      value="<%= notaventa.idorganizacion %>" placeholder="">
                    <input hidden type="text" class="form-control" name="nombreorganizacion"
                      value="<%= notaventa.nombreorganizacion %>" placeholder="">


                      <input hidden type="text" class="form-control" id="notaventa.organizacion_razonsocial"
                      value="<%=notaventa.organizacion_razonsocial %>" placeholder="">
                      <input hidden type="text" class="form-control" id="notaventa.organización_nombre"
                      value="<%=notaventa.organización_nombre %>" placeholder="">
                      <input hidden type="text" class="form-control" id="organinizacion_direccion_planta"
                      value="<%= notaventa.organinizacion_direccion_planta %>" placeholder="">
                      <input hidden  type="text" class="form-control" id="organinizacion_direccion_administracion"
                      value="<%=notaventa.organinizacion_direccion_administracion %>" placeholder="">

                      <div class="col-2">
                        <label>Nota de Venta</label>
                        <input type="text" class="form-control" name="" value="<%= notaventa.idorganizacion %>"
                          placeholder=""  hidden>
                          <h3 id="idnv"><%= notaventa.idnotaventa %></h3>
                      </div>
                    <div class="col-2">
                      <label>Id Cliente</label>
                      <input type="text" class="form-control" name="" value="<%= notaventa.idorganizacion %>"
                        placeholder=""  hidden>
                        <h3><%= notaventa.idorganizacion %></h3>
                    </div>
                    <div class="col-6">
                      <label>Cliente</label>
                      <input type="text" class="form-control" name="" value="<%= notaventa.nombreorganizacion %>"
                        placeholder=""  hidden>
                        <h3><%= notaventa.nombreorganizacion %></h3>
                    </div>
                    <div class="col-2" hidden>
                      <a href="selectorganizacion" type="button">
                        <i class="bi bi-pencil"></i>
                      </a>
                    </div>
                  </div>
                  <div  <% if((user.role=="ADM" )||(user.role=="SIS" )||(user.role=="VEN" )){ %>  <% } else{ %> hidden   <% } %> >
                 
                  
                  <div class="row form-group mb-4">
                    <div class="col-12">
                      <h5>Datos del Item</h5>
                      <div class="table-responsive ">

                        <table class="table table-striped table-success ">
                          <thead>
                            <tr>
                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                                Título
                              </th>
                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 col-1 ">
                                Mercado
                              </th>
                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                Un. Negocio
                              </th>



                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                Fecha Venta
                              </th>
                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                Fecha Entrega
                              </th>
                              <% if((user.role=="ADM" )||(user.role=="SIS" )||(user.role=="VEN" )){ %>
                                <th
                                  class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                  Precio 1 U$S
                                </th>
                                <th
                                  class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                  Precio 2 U$S
                                </th>
                            </tr>

                            <% } else{ %>
                              <% } %>




                          </thead>
                          <tbody>
                            <tr>
                              <td class="  ">
                                <input type="text" class="" id="titulo" size="50" name="titulo"
                                  value="<%= notaventa.titulo %>" placeholder="" required>
                              </td>
                              <td class="  ">
                                <select class="" name="mercado">
                                  <option value="<%= notaventa.mercado %>">
                                    <%= notaventa.mercado %>
                                  </option>
                                  <option value="UN-1">Int</option>
                                  <option value="UN-2">Expo</option>
                                </select>
                              </td>
                              <td class=" ">
                                <select class="" name="unidadnegocio">
                                  <option value="<%= notaventa.unidadnegocio %>">
                                    <%= notaventa.unidadnegocio %>
                                  </option>
                                  <option value="UN-1">UN-1</option>
                                  <option value="UN-2">UN-2</option>
                                </select>
                              </td>
                              <td class="  ">

                                <input type="text" class="" size="15" name="fechaventa" id="fechaventa"
                                  value="<%= notaventa.fechaventa%>" placeholder="" required>
                              </td>
                              <td class=" ">
                                <input type="text" class="" size="15" name="fechaentrega" id="fechaentrega"
                                  value="<%= notaventa.fechaentrega%>" placeholder="" required>
                              </td>
                              <!-- <td class=" ">
                                    <input type="date" name="fechaentrega" id="dt2" onchange="mydate1(2);"/>
                                    <input type="text" id="ndt2" onclick="mydate(2);" hidden />
                                    <input type="button" id="ndi2" Value="<%= notaventa.fechaentrega1 %>" onclick="mydate(2);" />
                                    <input type="button" id="ndx2" Value="X" onclick="mydateinv(2);" hidden/>
                                  </td> -->
                              </th>
                              
                                <td class=" " <% if((user.role=="ADM" )||(user.role=="SIS" )||(user.role=="VEN" )){ %><% } else{ %>
                                  hidden<% } %>>
                                  <input type="number" class="" id="precioventa" name="precioventa"
                                    value="<%= notaventa.precioventa%>" type="number" step="0.001" min="-1"
                                    placeholder=""  <% if((user.role=="ADM" )||(user.role=="SIS" )||(user.role=="VEN" )){ %><% } else{ %>
                                      hidden<% } %>>  

                                   

                                  </td>
                                <td <% if((user.role=="ADM" )||(user.role=="SIS" )||(user.role=="VEN" )){ %><% } else{ %>
                                  hidden<% } %>>
                                  <input type="number" class="" id="numero01" name="numero01"
                                    value="<%= notaventa.numero01%>" type="number" step="0.001" min="-1" placeholder="" required <% if((user.role=="ADM" )||(user.role=="SIS" )||(user.role=="VEN" )){ %><% } else{ %>
                                      hidden<% } %>>
                                    
                                </td>
                            </tr>
                            
                                </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>



                  <div class="row form-group mb-4">
                    <div class="col-12">
                      <table class="table table-striped table-success ">
                        <thead>
                          <table class="table table-striped table-success ">
                            <thead>
                              <tr>
                                <th
                                  class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                                  Orden
                                </th>

                                <th
                                  class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                                  Vendedor
                                </th>
                               

                                  <th
                                    class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-4">
                                    Link Carpeta en nube
                                  </th>
                                  
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td class=" ">
                                  <select class="" name="estado">
                                    <option value="<%= notaventa.estado%>">
                                      <%= notaventa.estado%>
                                    </option>
                                    <option value="Edicion">Edicion</option>
                                    <option value="Aprobada">Aprobada</option>
                                    <option value="Suspendida">Suspendida</option>
                                    <option value="Anulada">Anulada</option>
                                    <option value="Cerrada">Cerrada</option>
                                  </select>
                                </td>
                                <td>
                                  <select class="" name="vendedor">
                                    <option value="<%= notaventa.vendedor%>">
                                      <%= notaventa.vendedor%>
                                    </option>
                                    <option value="Javier Coria">Javier Coria</option>
                                    <option value="Ruben Eggel">Rubén Eggel</option>
                                    <option value="Carlos Carrizo">Carlos Carrizo</option>
                                    <option value="Antonela Uriarte">Antonela Uriarte</option>
                                    <option value="Gonzalo Pinery">Gonzalo Pinery</option>
                                    <option value=""></option>
                                    <option value=""></option>
                                  </select>
                                </td>

                             
                                      <input hidden type="number" class="" id="entregado" name="entregado"
                                        value="<%= notaventa.entregado%>" type="number" step="0.001" min="0"
                                        placeholder="">

                                        <td class="" <% if((user.role=="GER" )||(user.role=="SIS" )){ %> <% } else{ %>hidden <% } %>>
                                          <input type="text" class="" id="string01" size="80" name="string01"
                                            value="<%= notaventa.string01%>" placeholder="" onchange="updatelink()">
                                          <a id="linkbutton" href="">Ir a la carpeta</a>
                                        </td>
                              <tr>
                              </tr>
                            </tbody>
                          </table> 
                    </div>
                  </div>
                
                  </div>


                  <!--  DATOS PARA MOSTRAR (NI VENTAS NI ADMINISTRACION) -->
                  <% if((user.role=="ADM" )||(user.role=="SIS" )||(user.role=="VEN" )){ %> <% } else{ %>
                   

                  <div class="row form-group mb-4">
                    <div class="col-12">
                      <h5>Datos del Item</h5>
                      <div class="table-responsive ">

                        <table class="table table-striped table-success ">
                          <thead>
                            <tr>
                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                                Título
                              </th>
                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 col-1 ">
                                Mercado
                              </th>
                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                Un. Negocio
                              </th>



                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                Fecha Venta
                              </th>
                              <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                Fecha Entrega
                              </th>
                              <th
                              class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                              Orden
                            </th>

                            <th
                              class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                              Vendedor
                            </th>

                          



                          </thead>
                          <tbody>
                            <tr>
                              <td class="  ">
                                <input disabled type="text" class="" id="titulo" size="50" name="titulo"
                                  value="<%= notaventa.titulo %>" placeholder="" required>
                              </td>
                              <td class="  ">
                                <select disabled class="" name="mercado">
                                  <option value="<%= notaventa.mercado %>">
                                    <%= notaventa.mercado %>
                                  </option>
                                  <option value="UN-1">Int</option>
                                  <option value="UN-2">Expo</option>
                                </select>
                              </td>
                              <td class=" ">
                                <select disabled class="" name="unidadnegocio">
                                  <option value="<%= notaventa.unidadnegocio %>">
                                    <%= notaventa.unidadnegocio %>
                                  </option>
                                  <option value="UN-1">UN-1</option>
                                  <option value="UN-2">UN-2</option>
                                </select>
                              </td>
                              <td class="  ">

                                <input disabled type="text" class="" size="15" name="fechaventa" id="fechaventa"
                                  value="<%= notaventa.fechaventa%>" placeholder="" required>
                              </td>
                              <td class=" ">
                                <input disabled type="text" class="" size="15" name="fechaentrega" id="fechaentrega"
                                  value="<%= notaventa.fechaentrega%>" placeholder="" required>
                              </td>
                              <td class=" ">
                                <select disabled class="" name="estado">
                                  <option value="<%= notaventa.estado%>">
                                    <%= notaventa.estado%>
                                  </option>
                                  <option value="Edicion">Edicion</option>
                                  <option value="Aprobada">Aprobada</option>
                                  <option value="Suspendida">Suspendida</option>
                                  <option value="Anulada">Anulada</option>
                                  <option value="Cerrada">Cerrada</option>
                                </select>
                              </td>
                              <td>
                                <select  disabled class="" name="vendedor">
                                  <option value="<%= notaventa.vendedor%>">
                                    <%= notaventa.vendedor%>
                                  </option>
                                  <option value="Javier Coria">Javier Coria</option>
                                  <option value="Ruben Eggel">Rubén Eggel</option>
                                  <option value="Carlos Carrizo">Carlos Carrizo</option>
                                  <option value="Antonela Uriarte">Antonela Uriarte</option>
                                  <option value="Gonzalo Pinery">Gonzalo Pinery</option>
                                  <option value=""></option>
                                  <option value=""></option>
                                </select>
                              </td>
                              <!-- <td class=" ">
                                    <input type="date" name="fechaentrega" id="dt2" onchange="mydate1(2);"/>
                                    <input type="text" id="ndt2" onclick="mydate(2);" hidden />
                                    <input type="button" id="ndi2" Value="<%= notaventa.fechaentrega1 %>" onclick="mydate(2);" />
                                    <input type="button" id="ndx2" Value="X" onclick="mydateinv(2);" hidden/>
                                  </td> -->
                              </th>
                              
                              
                            </tr>
                            
                                </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>

                  <% } %>


                  <!-- Notas
                  Notas
                  NOTAS -->


                  <div class="d-flex justify-content-between flex-wrap flex-md nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                  </div>
                  <div class="row">
                    <div class=" col-1">
                      <div id="notasvisible" hidden>
                        <a type="button">
                          <i class="bi bi-arrow-up-square-fill " onclick=" notasinvisible()"> </i>
                        </a>
                      </div>
                      <div id="notasinvisible">
                        <a type="button">
                          <i class="bi bi-arrow-down-square-fill" onclick=" notasvisible()"> </i>
                        </a>
                      </div>
                    </div>
                    <div class="col-1">
                      <h4>
                        Notas
                      </h4>
                    </div>
                  </div>

                  <div id="notasvisible1" hidden>
                    <div class="row">
                      <div class="col-6">
                        <table class="table table-striped table-success ">
                          <thead>
                            <tr>
                              <th
                                class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-12">
                                </textarea>
                                Observaciones (p/ todos los dptos.)
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td class=" text-secondary text-xs font-weight-bolder text-black-100 " <% if((user.role=="VEN" )||(user.role=="SIS" )){ %> <% } else{ %>hidden <% } %>>
                                <textarea class="form-control" name="details" id="details" cols="30"
                                  rows="6"><%= notaventa.details%></textarea>
                              </td>
                              <td class=" text-secondary text-xs font-weight-bolder text-black-100 " <% if((user.role=="VEN" )||(user.role=="SIS" )){ %> hidden<% } else{ %> <% } %>>
                                <textarea disabled class="form-control" name="details" id="details" cols="30"
                                  rows="6"><%= notaventa.details%></textarea>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      
                      <% if((user.role=="SIS" )||(user.role=="ADM" )){ %>
                        <div class="col-6">
                          <table class="table table-striped table-success ">
                            <thead>
                              <tr>
                                <th
                                  class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-12">
                                  Notas Dpto. de Administracion
                                </th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td class=" text-secondary text-xs font-weight-bolder text-black-100 ">
                                  <textarea class="form-control" name="formapago" id="formapago" value="" cols="30"
                                    rows="6"><%= notaventa.formapago%></textarea>
                                </td>
                            </tbody>
                          </table>          
                        </div>
                        <% } else{ %>

                          <% } %>
                          <% if((user.role=="VEN" )||(user.role=="SIS" )){ %>
                        <div class="col-6">
                          <table class="table table-striped table-success ">
                            <thead>
                              <tr>
                                <th
                                  class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-12">
                                  </textarea>
                                  Nota Dpto. de Ventas
                                </th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td class=" text-secondary text-xs font-weight-bolder text-black-100 ">
                                  <textarea class="form-control" name="notaventa" id="details" cols="30"
                                    rows="6"><%= notaventa.notaventa%></textarea>
                                </td>
                              </tr>
                            </tbody>  
                          </table>
                        </div>
                        <div class="col-6">



                          <table class="table table-striped table-success ">
                            <thead>
                              <tr>
                                <th
                                  class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-12">
                                  </textarea>
                                  Nota Dpto. de Ventas a Administración
                                </th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td class=" text-secondary text-xs font-weight-bolder text-black-100 "  <% if((user.role=="VEN" )||(user.role=="SIS" )){ %> <% } else{ %>hidden <% } %>>
                                  <textarea class="form-control" name="notaventaadministracion" id="details" cols="30"
                                    rows="6"><%= notaventa.notaventaadministracion%></textarea>
                                </td> 
                                <td class=" text-secondary text-xs font-weight-bolder text-black-100 "  <% if(user.role=="ADM" ){ %>hidden  <% } else{ %><% } %>>
                                  <textarea disabled class="form-control" name="notaventaadministracion" id="details" cols="30"
                                    rows="6"><%= notaventa.notaventaadministracion%></textarea>
                                </td> 
                              </tr>     
                            </tbody>
                          </table>
                        </div>
                        <% } else{ %>

                          <% } %>
                            <div class="col-6">
                              <table class="table table-striped table-success ">
                                <thead>
                                  <tr>
                                    <th
                                      class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-12">
                                      </textarea>
                                      Nota Dpto. de Ventas a Producción
                                    </th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td class=" text-secondary text-xs font-weight-bolder text-black-100 " <% if((user.role=="VEN" )||(user.role=="SIS" )){ %> <% } else{ %>hidden <% } %>>
                                      <textarea class="form-control" name="notaventaproduccion" id="notaventaproduccion" cols="30"
                                        rows="6"><%= notaventa.notaventaproduccion%></textarea>
                                    </td>
                                    <td class=" text-secondary text-xs font-weight-bolder text-black-100 " <% if((user.role=="ING" )||(user.role=="SIS" )){ %> <% } else{ %>hidden <% } %>>
                                      <textarea disabled  class="form-control" name="notaventaproduccion" id="notaventaproduccion" cols="30"
                                        rows="6"><%= notaventa.notaventaproduccion%></textarea>
                                    </td>
                                  </tr>     
                                </tbody>
                              </table>
                            </div>
                            <% if((user.role=="ING" )||(user.role=="SIS" )){ %>
                              <div class="col-6">
                                <table class="table table-striped table-success ">
                                  <thead>
                                    <tr>
                                      <th
                                        class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-12">
                                        </textarea>
                                        Nota Dpto. de Producción
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td class=" text-secondary text-xs font-weight-bolder text-black-100 ">
                                        <textarea class="form-control" name="notaproduccion" id="notaproduccion" cols="30"
                                          rows="6"><%= notaventa.notaproduccion%></textarea>
                                      </td>
                                    </tr>
                                  </tbody>     
                                </table>
                              </div>




                              <div class="col-6">



                                <table class="table table-striped table-success ">
                                  <thead>
                                    <tr>
                                      <th
                                        class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-12">
                                        </textarea>
                                        Nota Dpto. de Produccion a Ventas
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td class=" text-secondary text-xs font-weight-bolder text-black-100 "  <% if((user.role=="ING" )||(user.role=="SIS" )){ %> <% } else{ %>hidden <% } %>>
                                        <textarea class="form-control" name="notaproduccionventa" id="details" cols="30"
                                          rows="6"><%= notaventa.notaproduccionventa%></textarea>
                                      </td>
                                      <td class=" text-secondary text-xs font-weight-bolder text-black-100 "  <% if(user.role=="VEN" ){ %> <% } else{ %>hidden <% } %>>
                                        <textarea disabled class="form-control" name="notaproduccionventa" id="details" cols="30"
                                          rows="6"><%= notaventa.notaproduccionventa%></textarea>
                                      </td>
                                    </tr>   
                                  </tbody>
                                </table>
                              </div>


                    </div>
                    <% } else{ %>

                      <% } %>
                  </div>
                </div>
                <div
                  class="d-flex justify-content-between flex-wrap flex-md nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                </div>
                <!-- PLAN DE PAGOS------------------------------------------------>
                <!-- PLAN DE PAGOS------------------------------------------------>
                <!-- PLAN DE PAGOS------------------------------------------------>
                
                  <div <% if((user.role=="VEN" )||(user.role=="SIS" )||(user.role=="GER" )||(user.role=="ADM" )){ %> <% } else{ %>hidden<% } %>>

                  
                  <div class="row form-group mb-4"     >

                    <div class="col-2">
                      <h5>Plan de pagos</h5>
                    </div>
                    <div class="col-1">
                      <input type="button" onclick="agregarpago()" value="+" <% if((user.role=="VEN" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %> />
                    </div>
                  </div>
                  <div class="row form-group mb-4">
                    <div class="table-responsive ">
                      <div class="col-6">
                        <table class="table table-striped table-success ">
                          <thead>
                            <tr>
                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                Concepto
                              </th>
                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                % Pago 1
                              </th>
                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                % Pago 1
                              </th>
                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                Fecha estimada
                              </th>
                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                Valor 1 u$S
                              </th>
                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                Valor 2 u$S
                              </th>
                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">

                              </th>  
                            </tr>
                          </thead>
                          <tbody id="planpagotabla" <% if((user.role=="VEN" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>>
                          </tbody>
                          <tbody id="planpagotabla-solovista" <% if((user.role=="SIS" )||(user.role=="GER" )||(user.role=="ADM" )){ %> <% } else{ %>hidden<% } %>>
                          </tbody>

                          
                        </table>
                      </div>
                    </div>
                  </div>
              </div>
            </div>
              <input id="planpago" name="planpago" type="text" value="<%=notaventa.planpago %>" hidden>
              <input id="planpagocant" name="planpagocant" type="number" value="0" hidden>
            </div>
            <!-- PLAN ENTREGA------------------------------------------------>
            <!-- PLAN ENTREGA------------------------------------------------>
            <!-- PLAN ENTREGA------------------------------------------------>

            

            <div <% if((user.role=="VEN" )||(user.role=="SIS" )||(user.role=="ING" )||(user.role=="ADM" )){ %> <% } else{ %>hidden<% } %>>

                  <div class="row form-group mb-4">

                    <div class="col-2">
                      <h5>Plan de entregas</h5>
                    </div>
                    <div class="col-1">
                      <input type="button" onclick="agregarentrega()" value="+" <% if((user.role=="VEN" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>/>
                    </div>
                  </div>
                  <div class="row form-group mb-4">
                    <div class="table-responsive ">
                      <div class="col-6">
                        <table class="table table-striped table-success ">
                          <thead>
                            <tr>
                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                Concepto
                              </th>
                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                %
                              </th>

                              <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                Fecha estimada
                              </th>


                            </tr>
                          </thead>
                          

                            <tbody id="planentregatabla" <% if((user.role=="VEN" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>>
                            </tbody>
                            <tbody id="planentregatabla_solovista" <% if((user.role=="SIS" )||(user.role=="ING" )||(user.role=="ADM" )){ %> <% } else{ %>hidden<% } %>>
                            </tbody>


                       
                
                        </table>
                      </div>
                    </div>
                  </div>
                  </div>
          </div>
          <input id="planentrega" name="planentrega" type="text" value="<%=notaventa.planentrega %>" hidden>
          <input id="planentregacant" name="planentregacant" type="number" value="0" hidden>
          </div>





              <!-- FACTURAS------------------------------------------------>
              <!-- FACTURAS------------------------------------------------>
              <!-- FACTURAS------------------------------------------------>
              <div <% if((user.role=="GER" )||(user.role=="SIS" )||(user.role=="ADM" )||(user.role=="VEN" )){ %> <% } else{ %>hidden<% } %>>

                <div class="row form-group mb-4">

                  <div class="col-2">
                    <h5>Facturación</h5>
                  </div>
                  <div class="col-1">
                    <input type="button" onclick="agregarfactura()" value="+" <% if((user.role=="ADM" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>/>
                  </div>
                </div>
                <div class="row form-group mb-4">
                  <div class="table-responsive ">
                    <div class="col-6">
                      <table class="table table-striped table-success ">
                        <thead>
                          <tr>
                            <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                              ID
                            </th>
                            <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                              Tipo | IVA
                            </th>
                            <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                              P.Venta | Nº Factura
                            </th>
                          
                            <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                              Monto $ | Monto U$S
                            </th>
                     
                            <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                              Fecha
                            </th>
                            <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                              Nota
                            </th>
                            <th class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                            </th>
                          </tr>
                        </thead>                
                          <tbody id="facturatabla" <% if((user.role=="ADM" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>>
                          </tbody>
                          <tbody id="facturatabla_solovista" <% if((user.role=="VEN" )||(user.role=="GER" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>>
                          </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
                <input id="factura" name="factura" type="text" value="<%=notaventa.factura %>" hidden>
                <input id="facturacant" name="facturacant" type="number" value="0" hidden>
                </div>

              
                    <!-- COBRANZA------------------------------------------------>
                    <!-- COBRANZA------------------------------------------------>
                    <!-- COBRANZA------------------------------------------------>
                    <div <% if((user.role=="GER" )||(user.role=="SIS" )||(user.role=="ADM" )||(user.role=="VEN" )){ %> <% } else{ %>hidden<% } %>>
                      <div class="row form-group mb-4">
                        <div class="col-2">
                          <h5>COBRANZA</h5>
                        </div>
                        <div class="col-1">
                          <input type="button" onclick="agregarcobro()" value="+" <% if((user.role=="ADM" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>/>
                        </div>
                      </div>
                      <div class="row form-group mb-4">
                        <div class="table-responsive ">
                          <div class="col-6">
                            <table class="table table-striped table-success ">
                              <thead>
                                <tr>
                                  <th
                                  class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                 ID
                                </th>
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Medio
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    P.Venta | Nº Factura
                                  </th>
                                  <!-- <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Nº Factura
                                  </th> -->
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Monto1 $ | Monto1 U$S
                                  </th>
                                  <!-- <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Monto1 U$S
                                  </th> -->
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Monto2 $ | Monto2 U$S
                                  </th>
                                  <!-- <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Monto2 U$S
                                  </th> -->
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Fecha |  Dias Dif.
                                  </th>
                                  <!-- <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Dias Dif.
                                  </th> -->
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Nota
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">

                                  </th>
                                </tr>
                              </thead>
                             
                                <tbody id="cobrotabla" <% if((user.role=="ADM" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>>
                                </tbody>
                                <tbody id="cobrotabla_solovista" <% if((user.role=="VEN" )||(user.role=="GER" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>>
                              
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                      <input id="cobro" name="cobro" type="text" value="<%=notaventa.cobro %>" hidden>
                      <input id="cobrocant" name="cobrocant" type="number" value="0" hidden>
                      </div>

                    
                    <!-- ENTREGA------------------------------------------------>
                    <!-- ENTREGA------------------------------------------------>
                    <!-- ENTREGA------------------------------------------------>
                    <div <% if((user.role=="GER" )||(user.role=="SIS" )||(user.role=="ADM" )||(user.role=="VEN" )||(user.role=="ING" )){ %> <% } else{ %>hidden<% } %>>
                      <div class="row form-group mb-4">
                        <div class="col-2">
                          <h5>Entregas</h5>
                        </div>
                        <div class="col-1">
                          <input type="button" onclick="agregarentrega()" value="+" <% if((user.role=="SIS" )||(user.role=="ING" )){ %> <% } else{ %>hidden<% } %>/>
                        </div>
                      </div>
                      <div class="row form-group mb-4">
                        <div class="table-responsive ">
                          <div class="col-6">
                            <table class="table table-striped table-success ">
                              <thead>
                                <tr>
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Título
                                  </th>
                                  <th
                                  class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                  Remito Electr.
                                </th>
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Remito Talonario Nº
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Porcentaje
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Fecha
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-s font-weight-bolder opacity-100 ps-2 col-1">
                                    Observacion
                                  </th>
                                 
                                </tr>
                              </thead>
                             
                                <tbody id="entregatabla" <% if((user.role=="ADM" )||(user.role=="SIS" )||(user.role=="ING" )){ %> <% } else{ %>hidden<% } %>>
                                </tbody>
                                 <tbody id="entregatabla_solovista" <% if((user.role=="VEN" )||(user.role=="GER" )||(user.role=="SIS" )){ %> <% } else{ %>hidden<% } %>>
                              
                              </tbody> 
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                      <input hidden id="entrega" name="entrega" type="text" value="<%=notaventa.entrega %>" >
                      <input hidden id="entregacant" name="entregacant" type="number" value="0" >
                      </div>





                          <!-- ITEM AGREGADOS------------------------------------------------>
                          <!-- ITEM AGREGADOS------------------------------------------------>
                          <!-- ITEM AGREGADOS------------------------------------------------>



                          <div class="row form-group mb-4">
                            <div class="col">
                              
                              <input hidden type="text" class="" id="itemagregadocant" name="itemagregadocant" value="0"
                                placeholder="">
                               
                                <input  hidden type="text" class="" id="itementregadocant" name="itementregadocant" value="0"
                                placeholder="">
                              <input hidden  type="text" class="" id="indicatoragregadocant" name="indicatoragregadocant"
                                value="0" placeholder="" hidden>
                            </div>
                          </div>


                          <div class="row my-4">
                            <div class="col-lg-12 col-md-12 mb-md-0 mb-4">
                              <div class="card">
                                <div class="card-header pb-0">
                                  <div class="row">
                                    <div class="col-lg-4 col-7">
                                      <h6>
                                        Componentes del conjunto
                                      </h6>
                                    </div>
                                  </div>
                                  <div
                                    class="d-flex justify-content-between flex-wrap flex-md nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                                  </div>

                                  <input hidden type="text" name="archivos-cant" id="archivos-cant" disabled>
                                  <input hidden type="text" name="archivos" id="archivos-0" disabled>
                                  <input hidden type="text" name="archivos-compras" id="archivos-1" disabled>
                                  <input hidden type="text" name="archivos-ingenieria" id="archivos-2" disabled>
                                  <input hidden type="text" name="archivos-torneria" id="archivos-3" disabled>
                                  <input hidden type="text" name="archivos-armado" id="archivos-4" disabled>
                                  <input hidden type="text" name="archivos-pañol" id="archivos-5" disabled>
                                  <input hidden type="text" name="archivos-corteyplegado" id="archivos-6" disabled>
                                  <input hidden type="text" name="archivos-administracion" id="archivos-7" disabled>
                                  <input hidden type="text" name="archivos-ventas" id="archivos-8" disabled>
                                  <input hidden type="text" name="archivos-gerencia" id="archivos-9" disabled>
                                  <input hidden type="text" name="archivos-calidad" id="archivos-10" disabled>
                                  <input hidden type="text" name="archivos-electricidad" id="archivos-11" disabled>
                                  <input hidden type="text" name="archivos-electricidad" id="archivos-12" disabled>
                                  <input hidden type="text" name="archivos-electricidad" id="archivos-13" disabled>
                                  <input hidden type="text" name="archivos-electricidad" id="archivos-14" disabled>
                                  <input hidden type="text" name="archivos-electricidad" id="archivos-15" disabled>
                                  <input hidden size="120" type="text" name="files_upload" id="files_upload"
                                    value="<%= notaventa.files_upload%>">
        </form> 

        <form action="../searchitemagregado" id="myForm" method="post">
          <div class="input-group">
            <!-- <span class="input-group-text text-body"><i class="fa fa-plus" aria-hidden="true"
                            onclick="document.getElementById('myForm').submit();"></i></span> -->
            <input type="text" class="form-control" name="searchTerm" value="" placeholder="" hidden>
            <input type="text" class="form-control" name="itemcompra" value="<%=notaventa._id %>" placeholder="" hidden>
          </div>
          <button id="btnactualizaritem" class="btn btn-info" onclick="document.getElementById('myForm').submit();">+
            Adjuntar Item</button>
        </form>
        <div class="row form-group mb-4">
          <div class="table-responsive ">
            <table class="table table-striped table-success ">
              <thead>
                <tr>
                  <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 col-3 ">
                    <div class="row">
                      <div class="col-8">Ord.Nº | Cant.Req | Stock| Entreg| Estado</div>
                      <!-- <div class="col-4 "> Motivo</div> -->
                  </th>

                  <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 col-2">
                    <div class="row">
                      <div class="col-8">ID | Código </div>
                      <div class="col-4">Referencia</div>
                  </th>
                  <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 col-3">Descripción</th>
                  <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 col-1"> Adap. | Retr. |
                    Desv.</th>
                  <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">Tipo | Rubro 
                  </th>


                  <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">Costo  <% if((user.role=="GER" )||(user.role=="SIS" )){ %> |
                    Precio | Precio Adopt. <% } else{ %> <% } %>
                  </th>



                </tr>
              </thead>
              <tbody>

              

                <% var i=0;notaventa.itemagregado.forEach(element=> { %>
                  <tr>
                    <td class=" text-secondary text-xs font-weight-bolder text-black-100  ">
                      <div class="row">
                        <div class="col-3">
                          <input size="2" class="" id="ao<%=i%>" value="<%= i+1 %>" step="1" min="0"
                            max="<%= notaventa.itemagregado.length %>" onchange="ordenaritem()" />
                        </div>
                        <div class="col-3" >
                          <input size="2" class="" id="aa<%=i%>" value="<%= element.cant %>"
                            onchange="actualizaritem()" /> --- <%= element.stock1 %>
                            <div id="aau<%=i%>"><%= element.unidad %></div>
                            
                          </div>
                          <div class="col-2" >
                          <input hidden ="2" class="" id="aaentregado<%=i%>" value="<%= element.entregadocant %>"
                            onchange="actualizaritem()" />
                            <input size="2"disabled ="2" class="" id="aaentregado<%=i%>" value="<%= element.ecant %>"
                            onchange="actualizaritem()" />
                            <div id="aau<%=i%>"><%= element.unidad %></div>
                           
                        
                        </div>
                        <div class="col-2">
                          <select id="ag<%=i%>" class="" aria-label="Default select example"
                            onchange="cambiarestadoitem('<%=i%>')">
                            <option value=" <%= element.estado %> " selected>
                              <%= element.estado %>
                            </option>
                            <option value="Edicion">Edicion</option>
                            <option value="Aprobado">Aprobado</option>
                            <option value="Anulado">Anulado</option>
                          </select>
                        

                        </div>
                        <div class="col-3 hidden">
                          <select id="ak<%=i%>" class="" aria-label="Default select example hidden"
                            onchange="actualizaritem()" hidden>
                            <option value=" <%= element.motivo %> " selected>
                              <%= element.motivo %>
                            </option>
                            <option value="Normal">Normal</option>
                            <option value="Adaptación">Adaptación</option>
                            <option value="Retrabajo">Retrabajo</option>
                            <option value="Desviación">Desviación</option>
                          </select>


                        </div>
                        <div class="row" hidden>
                          <div class="col-3 offset-6">
                                <input size="2" class="" id="aq<%=i%>" value="<%= element.usuario %>" />
                        <input size="9" class="" id="ar<%=i%>" value="<%= element.fecha %>" />
                          </div>
                        </div>
                    
                    </td>


                    <td class=" text-secondary text-xs font-weight-bolder text-black-100">
                      <div class="row">
                        <div id="aan<%=i%>" class="col-8 <% if(element.tipoitem=='Venta'){ %>text-danger <% } %> <% if(element.tipoitem=='Título'){ %>text-success <% } %>">
                          <a  class="text-success"  href="/itemcompra/edit/<%= element._id %>"><%= element.iditemcompra %>-<%= element.hijo %></a>
                          
                              |<% if(element.cant=='0'){ %><del> <% } %> <%= element.nombre %> <% if(element.cant=='0'){ %></del> <% }%>
                              
                              <div hidden>
                                <p  id="aaaid<%=i%>" class="text-xs font-weight-bolder "><%= element.iditemcompra %></p> - <p  id="aaahijo<%=i%>"><%= element.hijo %></p> | <p  id="aaanombre<%=i%>"><%= element.nombre %></p>
                              </div>
                        </div>
                        <div class="col-4">
                          <input hidden type="text" size="8" class="" id="al<%=i%>" value="<%= element.referencia%>"
                            onchange="actualizaritem()" />
                        </div>
                      </div>

                    </td>

                    <td id="aaaobservacion<%=i%>" class="text-xs font-weight-bolder <% if(element.tipoitem=='Venta'){ %>text-danger <% } %> <% if(element.tipoitem=='Título'){ %>text-success <% } %>">
                      <% if(element.cant=='0'){ %><del> <% } %> <%= element.observacion %> <% if(element.cant=='0'){ %></del> <% }%>

                    </td>
                    <td>
                      <div class="row">
                        <div class="col-4">
                          <div id="adaptacionvisible">
                            <a type="button">
                              <i class="bi bi-arrow-up-square-fill " id="adaptacion_up_<%= i %>"
                                onclick=" adaptacioninvisible('<%= i %>')" hidden> </i>
                              <% if(element.textoadaptacion==''){ %> <i class="bi bi-plus"
                                  id="adaptacion_down_<%= i %>" onclick=" adaptacionvisible('<%= i %>')"> </i>
                                <%} else{ %> <i class="bi bi-arrow-down-square-fill" id="adaptacion_down_<%= i %>"
                                    onclick=" adaptacionvisible('<%= i %>')"> </i>
                                  <%} %>
                            </a>
                          </div>
                        </div>
                        <div class="col-4">
                          <div id="retrabajovisible">
                            <a type="button">
                              <i class="bi bi-arrow-up-square-fill " id="retrabajo_up_<%= i %>"
                                onclick=" retrabajoinvisible('<%= i %>')" hidden> </i>
                              <% if(element.textoretrabajo==''){ %> <i class="bi bi-plus"
                                  id="retrabajo_down_<%= i %>" onclick=" retrabajovisible('<%= i %>')"> </i>
                                <%} else{ %> <i class="bi bi-arrow-down-square-fill" id="retrabajo_down_<%= i %>"
                                    onclick=" retrabajovisible('<%= i %>')"> </i>
                                  <%} %>
                            </a>
                          </div>
                        </div>

                        <div class="col-4">
                          <div id="desviacionvisible">
                            <a type="button">
                              <i class="bi bi-arrow-up-square-fill " id="desviacion_up_<%= i %>"
                                onclick=" desviacioninvisible('<%= i %>')" hidden> </i>
                              <% if(element.textodesviacion==''){ %> <i class="bi bi-plus"
                                  id="desviacion_down_<%= i %>" onclick=" desviacionvisible('<%= i %>')"> </i>
                                <%} else{ %> <i class="bi bi-arrow-down-square-fill" id="desviacion_down_<%= i %>"
                                    onclick=" desviacionvisible('<%= i %>')"> </i>
                                  <%} %>
                            </a>
                          </div>
                        </div>


                    </td>

                    <td class=" text-secondary text-xs font-weight-bolder text-black-100">
                      <%= element.tipoitem %>|

                        <%= element.rubroitem %>
                    </td>
                    <td class=" text-secondary text-xs font-weight-bolder text-black-100" ">
                      <div class=" row">
                      <div class="col-3" id="dd<%=i%>" hidden>

                        <%= (parseInt(element.costoarbol)) %>
                      </div>
                      <div class="col-3" id="ddt<%=i%>">


                      </div>

                      <div class="col-3" id="ee<%=i%>" hidden>
                        <%= (parseInt(element.numero01)) %>
                      </div>
                      <div class="col-3" id="eet<%=i%>"   <% if((user.role=="VEN" )||(user.role=="SIS" )){ %>  <% } else{ %>hidden <% } %>>


                      </div>
                      <div class="col-4">
                        <input size="10" class="" id="ff<%=i%>" value="<%=element.preciocotizado %>" step="1" min="0"
                          onchange="actualizaritem()"  <% if((user.role=="VEN" )||(user.role=="SIS" )){ %>  <% } else{ %>hidden <% } %>>
                      </div>

          </div>
        </div>
        </td>

        <td class="text-end text-secondary text-xs font-weight-bolder text-black-100">
          <div class="justify-content-end ">
            <div class="espacio"></div>
            <a href="../viewItemagregado/<%=element._id %>,<%=notaventa._id %>" type="btn btn-info boton-color">

              <% if(element.itemagregado.length-1>0){ %>
                <i class="bi bi-paperclip">
                </i>
            </a>
            <%= element.itemagregado.length-1 %>
              <% } %>
                <% if(element.hijo>0){ %>
                  <a href=" ../../notaventa/edititemhijo/<%=element._id %>,<%=notaventa._id %>" type="button">
                    <i class="bi bi-pencil"></i>
                  </a>
                  <% } %>

                    <!-- <a href="../deleteitemagregado/<%=element._id %>,<%=notaventa._id %>,<%=i %>"
                      type="btn btn-info boton-color">
                      <i class="bi bi-trash"></i>
                    </a> -->
          </div>
        </td>
        </tr>
        <tr>
          <td id="adaptacion1_<%=i%>" hidden colspan="6"
            class="text-uppercase text-success text-xs font-weight-bolder opacity-100"> >>>>>>>>>> ADAPTACION >>>>>>>>>>
          </td>
        </tr>
        <tr id="adaptacion_<%=i%>" hidden>
         
          <td colspan="4">
            <textarea id="am<%=i%>" name="story" rows="3" cols="150" onchange="actualizaritem()"><%= element.textoadaptacion %></textarea>
          </td>
          <td colspan="2">
            <a href="url">link text</a>
            <a href="url">link text</a>
          </td>
        </tr>
        <div>
          <tr>
          <tr>
            <td id="adaptacion2_<%=i%>" hidden colspan="6"
              class="text-uppercase text-success text-xs font-weight-bolder opacity-100"> >>>>>>>>>> ADAPTACION
              >>>>>>>>>></td>
          </tr>
          <td id="retrabajo1_<%=i%>" hidden colspan="6"
            class="text-uppercase text-success text-xs font-weight-bolder opacity-100"> >>>>>>>>>> RETRABAJO >>>>>>>>>>
          </td>
          </tr>
          <tr id="retrabajo_<%=i%>" hidden>

            <td colspan="4">
              <textarea id="an<%=i%>" name="story" rows="3" cols="150" onchange="actualizaritem()"><%= element.textoretrabajo %></textarea>
            </td>
            <td colspan="2">
              <a href="url">link text</a>
              <a href="url">link text</a>
            </td>
          </tr>
          <tr>
            <td id="retrabajo2_<%=i%>" hidden colspan="6"
              class="text-uppercase text-success text-xs font-weight-bolder opacity-100">
              <<<<<<<<< RETRABAJO <<<<<<<<<<<<<</td>
          </tr>
          <tr>
            <td id="desviacion1_<%=i%>" hidden colspan="6"
              class="text-uppercase text-success text-xs font-weight-bolder opacity-100"> >>>>>>>>>> DESVIACION
              >>>>>>>>>></td>
          </tr>
          <tr id="desviacion_<%=i%>" hidden>
           
            <td colspan="4">
              <textarea id="ap<%=i%>" name="story" rows="3" cols="150" onchange="actualizaritem()"><%= element.textodesviacion %></textarea>
            </td>
            <td colspan="2">
              <a href="url">link text</a>
              <a href="url">link text</a>
            </td>
          </tr>
          <tr>
            <td id="desviacion2_<%=i%>" hidden colspan="6"
              class="text-uppercase text-success text-xs font-weight-bolder opacity-100"> >>>>>>>>>> DESVIACION
              >>>>>>>>>></td>
          </tr>

          <% i++; }) %>
            <% %>
              <tr>
                <td>TOTALES</td>
                <td>----------------------</td>
                <td>----------------------</td>
                <td>----------------------</td>
                <td>----------------------</td>
                <td class=" text-secondary text-xs font-weight-bolder text-black-100" ">
                  <div class=" row">
                  <div class="col-3" id="ddtt">
                  </div>
                  <div class="col-3" id="eett"  <% if((user.role=="GER" )||(user.role=="SIS" )){ %>  <% } else{ %>hidden <% } %>>>
                  </div>
                  <div class="col-4" id="fftt"  <% if((user.role=="GER" )||(user.role=="SIS" )){ %>  <% } else{ %>hidden <% } %>>>
                  </div>
        </div>
        </div>
        </td>
        </tr>
        </tbody>
        </table>
        </div>
        </div>
        </div>
        <!-- itemstotales (cant) -->
        <input id="itemtotal" value="<%=i %>" hidden>
        <!-- costo agregados -->
        <input type="number" step="0.001" min="0" id="costoitemsagregados" value="0" hidden>
        <!-- costopropio -->
        <input type="number" step="0.001" min="0" id="costopropio" name="costopropio" value="0" hidden>
        <!-- costo arbol -->
        <input type="number" step="0.001" min="0" id="costoarbol" name="costoarbol" value="0" hidden>
        <!-- motivo -->
        <input type="text" id="string04" name="string04" value="<%= notaventa.string04%>" placeholder="" hidden>
        <!-- ref -->
        <input type="text" id="string05" name="string05" value="<%= notaventa.string05%>" placeholder="" hidden>
      
        <input type="text" id="itemagregadoestado" name="itemagregadoestado" value="<%= notaventa.itemagregadoestado%>" placeholder="" hidden>
        <!-- precio cotizado -->
        <input type="text" id="string06" name="string06" value="<%= notaventa.string06%>" placeholder="" hidden>
        <!-- adapt/retrab/desv -->
        <input type="text" id="string07" name="string07" value="<%= notaventa.string07%>" placeholder="" hidden>
        <input type="text" id="string10" name="string10" value="<%= notaventa.string10%>" placeholder="" hidden>
        <input type="text" id="string09" name="string09" value="<%= notaventa.string09%>" placeholder="" hidden >
        
        <input  hidden type="text" id="string11" name="string11" value="<%= notaventa.string11%>" placeholder=""  >  
      </div>


        
          <div class="row my-4" <% if((user.role=="VEN" )||(user.role=="SIS" )||(user.role=="SIS" )||(user.role=="ADM" )||(user.role=="ING" )){ %>    <% } else{ %> hidden   <% } %>>
            <div class="col-lg-12 col-md-12 mb-md-0 mb-4">
              <div class="card">
                <div class="card-header pb-0">
                  <h6>
                    Documentos y su distribución
                  </h6>
                  <div
                    class="d-flex justify-content-between flex-wrap flex-md nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                  </div>
                </div>
                <div class="row form-group mb-4">
                  <div class="table-responsive ">
                    <table class="table table-striped table-success ">
                      <thead>
                        <tr>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2">
                            Nombre (Link)</th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-3">
                            Descripcion </th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Orden Compra</th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Compras
                          </th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Depósito
                          </th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Torneria
                          </th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Armado
                          </th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">C
                            y Pleg.
                          </th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Pintura
                          </th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Calidad
                          </th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Electricidad</th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Terminación</th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Despacho
                          </th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Admin</th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Venta</th>
                          <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-1">
                            Ingenieria
                          </th>
                        </tr>
                      </thead>

                      <tbody id="archivoslista"> </tbody>

                    </table>
                  </div>
                </div>

                <div class="row form-group mb-4">
                  <div class="text-secondary text-xs font-weight-bolder text-black-100 col-4">
                    <input type="text" name="archivos" id="archivos" hidden>
                    <label for="filesfld" id="fileslbl" class="btn btn-success"
                      ondragover="stopDefault(event);dragOver(this, 'Arrastre archivos aqui o presione para seleccionar');"
                      ondragenter="stopDefault(event);dragOver(this, 'Arrastre archivos aqui o presione para seleccionar');"
                      ondragleave="stopDefault(event);dragLeave(this);"
                      ondrop="stopDefault(event);dragLeave(this);addFilesAndSubmit(event);">Arrastre
                      archivos aqui o presione para seleccionar

                    </label>
                    <form id="filesfrm" action="/upload" method="post" onsubmit="return submitFilesForm(this);">
                      <input type="file" name="filesfld" id="filesfld" accept="*" onchange="submitFilesForm(this.form);"
                        multiple hidden />
                      <div class="text-secondary text-xs font-weight-bolder text-black-100 col-6">
                      </div>
                    </form>
                  </div>
                </div>
                <div style="text-align: left;">
                  <div id="progress"></div>
                </div>
              </div>
            </div>
          </div>
         
              <!-- ---------COTIZACION-------- -->
              <!-- ---------COTIZACION-------- -->
              <!-- ---------COTIZACION-------- -->
              <!-- ---------COTIZACION-------- -->
              <!-- ---------COTIZACION-------- -->

              <div class="row my-4" hidden>
                <div class="col-lg-12 col-md-12 mb-md-0 mb-4">
                  <div class="card">
                    <div class="card-header pb-0">
                      <div class="row">
                        <div class="col-lg-4 col-7">
                          <h6>
                            Cotización
                          </h6>
                        </div>
                      </div>
                      <div
                        class="d-flex justify-content-between flex-wrap flex-md nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                      </div>
                      <form action="cotizacion/" method="POST">
                        <div class="row">
                          <div class=" col-12">

                            <button type="submit" class="btn btn-primary">Generar PDF</button>
                            <input type="text" id="generarpdf" name="generarpdf" size="30" class="form-control">

                            <input type="text" class="form-control" id="string02_a" name="string02_a"
                              value="<%= notaventa.string02 %>" placeholder="">
                            <input type="text" class="form-control" id="string03_a" name="string03_a"
                              value="<%= notaventa.string03 %>" placeholder="">

                          </div>

                          <div class="table-responsive ">

                            <table class="table table-striped table-success ">
                              <thead>
                                <tr>
                                  <th
                                    class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                                    Tipo Cotización
                                  </th>
                                  <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 col-2 ">
                                    Fecha Encabezado
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                                    Precios
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                    Cond.Técnicas
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                    Cond.Legales
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                    Imagen Portada
                                  </th>
                                  <th
                                    class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                    Anexos
                                  </th>

                                </tr>
                              </thead>

                              <body>
                                <td>
                                  <select id="generarpdf-1" onclick="actualizardatosPDF()">
                                    <option value="T-1" selected>T-1 (Simplificado)</option>
                                    <option value="T-2">T-2 (Completo)</option>
                                  </select>
                                </td>
                                <td>
                                  <input type="text" id="generarpdf-2" size="30" class="form-control"
                                    placeholder="Ej. 20 de Enero de 2024" onchange="actualizardatosPDF()">
                                </td>
                                <td>
                                  <select id="generarpdf-3" onclick="actualizardatosPDF()">
                                    <option value="P-1">P-1 (Precio x items)</option>
                                    <option value="P-2">P-2 (Precio x sectores)</option>
                                    <option value="P-2" selected>P-3 (Precio total)</option>
                                  </select>

                                </td>
                                <td>
                                  <input type="checkbox" id="generarpdf-4" value="" onchange="actualizardatosPDF()" />
                                </td>
                                <td>
                                  <input type="checkbox" id="generarpdf-5" value="" onchange="actualizardatosPDF()" />
                                </td>
                                <td>
                                  <input type="checkbox" id="generarpdf-6" value="" onchange="actualizardatosPDF()" />
                                </td>
                                <td>
                                  <input type="checkbox" id="generarpdf-7" value="" onchange="actualizardatosPDF()" />
                                </td>
                              </body>
                            </table>
                          </div>

                          <div id="especificacionesTecnicas" hidden>
                            <div class="table-responsive ">

                              <table class="table table-striped table-success ">
                                <thead>
                                  <tr>
                                    <th
                                      class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                                      Marca Motores
                                    </th>
                                    <th
                                      class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 col-2 ">
                                      Marca Reductores
                                    </th>
                                    <th
                                      class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                                      Marca Neumática
                                    </th>
                                    <th
                                      class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                      Tension potencia
                                    </th>
                                    <th
                                      class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-1">
                                      Tension comando
                                    </th>
                                  </tr>
                                </thead>

                                <body>
                                  <td>
                                    <select id="generarpdf-8" onchange="actualizardatosPDF()">
                                      <option value="" selected>NO ESPECIFICAR</option>
                                      <option value="Weg">Weg</option>
                                      <option value="Siemens">Siemens</option>
                                      <option value="Otro">Otro</option>
                                    </select>
                                    <input type="text" id="generarpdf-9" size="30" class="form-control"
                                      placeholder="Ej. Czerweny" onblur="actualizardatosPDF()" hidden>
                                  </td>
                                  <td>
                                    <select id="generarpdf-10" onclick="actualizardatosPDF()">
                                      <option value="" selected>NO ESPECIFICAR</option>
                                      <option value="STM">STM</option>
                                      <option value="Lentax">Lentax</option>
                                      <option value="Sew">Sew</option>
                                      <option value="Sumitomo">Sumitomo</option>
                                      <option value="Ratini">Ratini</option>
                                      <option value="Garro FabrilGarro Fabril">Garro Fabril</option>
                                      <option value="Otro">Otro</option>
                                    </select>
                                    <input type="text" id="generarpdf-11" size="30" class="form-control"
                                      placeholder="Ej. Nord" onclick="actualizardatosPDF()" hidden>
                                  </td>
                                  <td>
                                    <select id="generarpdf-12" onclick="actualizardatosPDF()">
                                      <option value="" selected>NO ESPECIFICAR</option>
                                      <option value="Micromecánica">Micromecánica</option>
                                      <option value="Festo">Siemens</option>
                                      <option value="SMC">SMC</option>
                                      <option value="Otro">Otro</option>
                                    </select>
                                    <input type="text" id="generarpdf-13" size="30" class="form-control"
                                      placeholder="Ej. Automación Arg." hidden>
                                  </td>

                                  <td>
                                    <select id="generarpdf-14" onclick="actualizardatosPDF()">
                                      <option value="" selected>NO ESPECIFICAR</option>
                                      <option value="380V-50Hz">380 Volt-50Hz</option>
                                      <option value="380V-60Hz">380 Volt-60Hz</option>
                                      <option value="380V-60Hz">440 Volt-60Hz</option>
                                      <option value="Otro">Otro</option>
                                    </select>
                                    <input type="text" id="generarpdf-15" size="30" class="form-control"
                                      placeholder="Ej. 110 Volt 60 Hz" hidden>
                                  </td>
                                  <td>
                                    <select id="generarpdf-16" onclick="actualizardatosPDF()">
                                      <option value="" selected>NO ESPECIFICAR</option>
                                      <option value="220 Volt-50Hz">220 Volt-50Hz</option>
                                      <option value="24 Volt Corr.Alterna">24 Volt Corr.Alterna </option>
                                      <option value="24 Volt Corr.Continua">24 Volt Corr.Continua </option>
                                      <option value="Otro">Otro</option>
                                    </select>
                                    <input type="text" id="generarpdf-17" size="30" class="form-control"
                                      placeholder="Ej. 110 Volt 60 Hz" onchange="actualizardatosPDF()" hidden>
                                  </td>

                                </body>
                              </table>
                            </div>

                            <div class="table-responsive ">

                              <table class="table table-striped table-success ">
                                <thead>
                                  <tr>
                                    <th
                                      class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-2">
                                      Titulo Característica
                                    </th>
                                    <th
                                      class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 col-4 ">
                                      Especificacion Característica
                                    </th>

                                  </tr>
                                </thead>

                                <body>
                                  <tr>
                                    <td>

                                      <input type="text" id="generarpdf-18" size="30" class="form-control"
                                        placeholder="Ej. Humedad material a moler" onchange="actualizardatosPDF()">
                                    </td>
                                    <td>

                                      <input type="text" id="generarpdf-19" size="30" class="form-control"
                                        placeholder="Ej. max 16 %" onchange="actualizardatosPDF()">
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>

                                      <input type="text" id="generarpdf-20" size="30" class="form-control"
                                        placeholder="Ej. Humedad material a moler" onchange="actualizardatosPDF()">
                                    </td>
                                    <td>

                                      <input type="text" id="generarpdf-21" size="30" class="form-control"
                                        placeholder="Ej. max 16 %" onchange="actualizardatosPDF()">
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>

                                      <input type="text" id="generarpdf-22" size="30" class="form-control"
                                        placeholder="Ej. Humedad material a moler" onchange="actualizardatosPDF()">
                                    </td>
                                    <td>

                                      <input type="text" id="generarpdf-23" size="30" class="form-control"
                                        placeholder="Ej. max 16 %" onchange="actualizardatosPDF()">
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>

                                      <input type="text" id="generarpdf-24" size="30" class="form-control"
                                        placeholder="Ej. Humedad material a moler" onchange="actualizardatosPDF()">
                                    </td>
                                    <td>

                                      <input type="text" id="generarpdf-25" size="30" class="form-control"
                                        placeholder="Ej. max 16 %" onchange="actualizardatosPDF()">
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>

                                      <input type="text" id="generarpdf-26" size="30" class="form-control"
                                        placeholder="Ej. Humedad material a moler" onchange="actualizardatosPDF()">
                                    </td>
                                    <td>

                                      <input type="text" id="generarpdf-27" size="30" class="form-control"
                                        placeholder="Ej. max 16 %" onchange="actualizardatosPDF()">
                                    </td>
                                  </tr>

                                </body>
                              </table>
                            </div>
                          </div>
                          <script>


                            function renderizardatosPDF() {
                              let a = document.getElementById("string02").value
                              arr = a.split(',')
                              document.getElementById("generarpdf-1").value = arr[0]
                              document.getElementById("generarpdf-2").value = arr[1]
                              document.getElementById("generarpdf-3").value = arr[2]
                              if (arr[3] == 'true') { document.getElementById("generarpdf-4").checked = true } else { document.getElementById("generarpdf-4").checked = false }
                              if (arr[4] == 'true') { document.getElementById("generarpdf-5").checked = true } else { document.getElementById("generarpdf-5").checked = false }
                              if (arr[5] == 'true') { document.getElementById("generarpdf-6").checked = true } else { document.getElementById("generarpdf-6").checked = false }
                              if (arr[6] == 'true') { document.getElementById("generarpdf-7").checked = true } else { document.getElementById("generarpdf-7").checked = false }

                              document.getElementById("generarpdf-8").value = arr[7]
                              document.getElementById("generarpdf-9").value = arr[8]
                              document.getElementById("generarpdf-10").value = arr[9]
                              document.getElementById("generarpdf-11").value = arr[10]
                              document.getElementById("generarpdf-12").value = arr[11]
                              document.getElementById("generarpdf-13").value = arr[12]
                              document.getElementById("generarpdf-14").value = arr[13]
                              document.getElementById("generarpdf-15").value = arr[14]
                              document.getElementById("generarpdf-16").value = arr[15]
                              document.getElementById("generarpdf-17").value = arr[16]
                              document.getElementById("generarpdf-18").value = arr[17]
                              document.getElementById("generarpdf-19").value = arr[18]
                              document.getElementById("generarpdf-20").value = arr[19]
                              document.getElementById("generarpdf-21").value = arr[20]
                              document.getElementById("generarpdf-22").value = arr[21]
                              document.getElementById("generarpdf-23").value = arr[22]
                              document.getElementById("generarpdf-24").value = arr[23]
                              document.getElementById("generarpdf-25").value = arr[24]
                              document.getElementById("generarpdf-26").value = arr[25]
                              document.getElementById("generarpdf-27").value = arr[26]

                            }



                            function actualizardatosPDF() {
                              let datosPDF = ""

                              // document.getElementById("generarpdf-26").value = text

                              let a = document.getElementById("generarpdf-1").value
                              datosPDF = datosPDF + a
                              a = document.getElementById("generarpdf-2").value
                              datosPDF = datosPDF + "," + a
                              a = document.getElementById("generarpdf-3").value
                              datosPDF = datosPDF + "," + a



                              if (document.getElementById("generarpdf-4").checked) {
                                datosPDF = datosPDF + "," + "true";
                                document.getElementById("especificacionesTecnicas").hidden = false
                              }
                              else {
                                datosPDF = datosPDF + "," + "false";
                                document.getElementById("especificacionesTecnicas").hidden = true
                              }
                              if (document.getElementById("generarpdf-5").checked) {
                                datosPDF = datosPDF + "," + "true";
                              }
                              else {
                                datosPDF = datosPDF + "," + "false";

                              }
                              if (document.getElementById("generarpdf-6").checked) {
                                datosPDF = datosPDF + "," + "true";
                              }
                              else {
                                datosPDF = datosPDF + "," + "false";

                              }
                              if (document.getElementById("generarpdf-7").checked) {
                                datosPDF = datosPDF + "," + "true";
                              }
                              else {
                                datosPDF = datosPDF + "," + "false";

                              }



                              if (document.getElementById("generarpdf-8").value == "Otro") {
                                document.getElementById("generarpdf-9").hidden = false
                              } else {
                                document.getElementById("generarpdf-9").hidden = true
                                document.getElementById("generarpdf-9").value = ''
                              }
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-8").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-9").value;

                              if (document.getElementById("generarpdf-10").value == "Otro") {
                                document.getElementById("generarpdf-11").hidden = false
                              } else {
                                document.getElementById("generarpdf-11").hidden = true
                                document.getElementById("generarpdf-11").value = ''
                              }
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-10").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-11").value;

                              if (document.getElementById("generarpdf-12").value == "Otro") {
                                document.getElementById("generarpdf-13").hidden = false
                              } else {
                                document.getElementById("generarpdf-13").hidden = true
                                document.getElementById("generarpdf-13").value = ''
                              }
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-12").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-13").value;

                              if (document.getElementById("generarpdf-14").value == "Otro") {
                                document.getElementById("generarpdf-15").hidden = false
                              } else {
                                document.getElementById("generarpdf-15").hidden = true
                                document.getElementById("generarpdf-15").value = ''
                              }
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-16").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-17").value;

                              if (document.getElementById("generarpdf-16").value == "Otro") {
                                document.getElementById("generarpdf-17").hidden = false
                              } else {
                                document.getElementById("generarpdf-17").hidden = true
                                document.getElementById("generarpdf-17").value = ''
                              }
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-16").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-17").value;

                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-18").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-19").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-20").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-21").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-22").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-23").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-24").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-25").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-26").value;
                              datosPDF = datosPDF + "," + document.getElementById("generarpdf-27").value;



                              document.getElementById("string02_a").value = datosPDF
                              document.getElementById("string02").value = datosPDF
                            }
                          </script>




                      </form>







                      <div class="row form-group mb-4">


                        <div class="table-responsive ">

                          <table class="table table-striped table-success ">
                            <thead>
                              <tr>

                                <th></th>

                                <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100">
                                  Profesion
                                </th>
                                <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2">
                                  Nombre</th>
                                <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2">
                                  Cargo</th>
                                <th
                                  class="text-center text-uppercase text-primary text-xs font-weight-bolder opacity-100">
                                  Email</th>
                                <th class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2">
                                  Telef.</th>


                              </tr>
                            </thead>
                            <tbody>
                              <% var i=0;persona.forEach(element=> { i++;%>
                                <tr>
                                  <td class=" text-secondary text-xs font-weight-bolder text-black-100">
                                    <input type="checkbox" id="per<%= i%>" name="per<%= i%>" value="" />
                                  </td>

                                  <td class=" text-secondary text-xs font-weight-bolder text-black-100">
                                    <%= element.profesion %>
                                  </td>
                                  <td
                                    class=" text-secondary text-xs font-weight-bolder text-black-100 id='pera<%= i%>'">
                                    <%= element.string01 %>
                                      <%= element.firstName %>
                                        <%= element.lastName %>
                                  </td>

                                  <td class=" text-secondary text-xs font-weight-bolder text-black-100">
                                    <%= element.cargo %>
                                  </td>
                                  <td class=" text-secondary text-xs font-weight-bolder text-black-100"
                                    id='perb<%= i%>'>
                                    <%= element.email %>
                                  </td>
                                  <td class=" text-secondary text-xs font-weight-bolder text-black-100"
                                    id='perc<%= i%>'>
                                    <%= element.tel %>
                                  </td>
                                  <td class="text-end text-secondary text-xs font-weight-bolder text-black-100">
                                    <div class="justify-content-end ">
                                      <div class="espacio"></div>
                                      <a href="../viewPersona/<%=element._id %>,<%=notaventa._id %>"
                                        type="btn btn-info boton-color">
                                        <i class="bi bi-eye "></i>
                                      </a>



                                    </div>
                                  </td>
                                  <td class="text-end text-secondary text-xs font-weight-bolder text-black-100">
                                    <div class="justify-content-end ">
                                      <div class="espacio"></div>


                                      <a href="../deletePersona/<%=element._id %>,<%=notaventa._id %>"
                                        type="btn btn-info boton-color">
                                        <i class="fa fa-user-times"></i>
                                      </a>

                                    </div>
                                  </td>
                                </tr>

                                <% }) %>
                            </tbody>
                          </table>
                        </div>



                        <div class="row my-4" hidden>
                          <div class="col-lg-12 col-md-12 mb-md-0 mb-4">
                            <div class="card">
                              <div class="card-header pb-0">
                                <div class="row">
                                  <div class="col-lg-4 col-7">
                                    <h6>
                                      Costos
                                    </h6>
                                  </div>
                                </div>
                                <div
                                  class="d-flex justify-content-between flex-wrap flex-md nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                                </div>
                                <div class="row">
                                  <div class=" col-2">
                                    <h6>
                                      Costos propio:
                                    </h6>
                                  </div>
                                  <div class=" col-2">
                                    <h6>
                                      valor
                                    </h6>
                                  </div>
                                </div>
                              </div>


                              <form action="../searchindicator" id="myForm" method="post">
                                <div class="input-group">
                                  <!-- <span class="input-group-text text-body"><i class="fa fa-plus" aria-hidden="true"
                                onclick="document.getElementById('myForm').submit();"></i></span> -->
                                  <input type="text" class="form-control" name="searchTermCosto" value="" placeholder=""
                                    hidden>
                                  <input type="text" class="form-control" name="notaventa" value="<%=notaventa._id %>"
                                    placeholder="" hidden>
                                </div>
                                <button id="btnactualizaritem" class="btn btn-info"
                                  onclick="document.getElementById('myForm').submit();">+ Adjuntar Indicador
                                  Costo</button>
                                <input type="text" class="form-control" name="searchTerm" value="" placeholder=""
                                  hidden>
                              </form>

                              <div class="row form-group mb-4">
                                <div class="row form-group mb-4">
                                  <div class="table-responsive ">
                                    <table class="table table-striped table-success ">
                                      <thead>
                                        <tr>
                                          <th
                                            class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2">
                                            Cant
                                          </th>
                                          <th
                                            class="text-uppercase text-primary text-xs font-weight-bolder opacity-100">
                                            Valor
                                            U$S</th>
                                          <th
                                            class="text-uppercase text-primary text-xs font-weight-bolder opacity-100">
                                            Nombre
                                          </th>
                                          <th
                                            class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2">
                                            Tipo
                                          </th>
                                          <th
                                            class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2">
                                            ID
                                          </th>
                                          <th
                                            class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2">
                                            Observ.
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <% var i=0; var costo=0; notaventa.indicatoragregado.forEach(element=> { %>
                                          <tr>
                                            <td class=" text-secondary text-xs font-weight-bolder text-black-100 col-1">
                                              <input class="" type="number" step="0.001" min="0" id="bb<%=i%>"
                                                value="<%= element.cant %>" onchange="actualizarindicator()" />
                                            </td>
                                            <td class=" text-secondary text-xs font-weight-bolder text-black-100 col-1"
                                              id="cc<%=i%>">
                                              <%= element.valor %>
                                            </td>
                                            <td class=" text-secondary text-xs font-weight-bolder text-black-100 col-3">
                                              <%= element.name %>
                                            </td>
                                            <td class=" text-secondary text-xs font-weight-bolder text-black-100 col-2">
                                              <%= element.tipo %>
                                            </td>

                                            <td class=" text-secondary text-xs font-weight-bolder text-black-100 col-1">
                                              <%= element.idindicator %>
                                            </td>
                                            <td class=" text-secondary text-xs font-weight-bolder text-black-100 col-3">
                                              <%= element.details %>
                                            </td>


                                            <td
                                              class="text-end text-secondary text-xs font-weight-bolder text-black-100 col-1">
                                              <div class="justify-content-end ">
                                                <div class="espacio"></div>

                                                <a href="../deleteindicator/<%=element._id %>,<%=notaventa._id %>"
                                                  type="btn btn-info boton-color">
                                                  <i class="bi bi-trash"></i>
                                                </a>

                                              </div>
                                            </td>
                                          </tr>

                                          <% i++; }) %>
                                            <input id="indicatortotal" value="<%=i %>" hidden>


                                            <% %>
                                      </tbody>
                                    </table>

                                  </div>
                                </div>



                              </div>
                            </div>

                            <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
                            <script
                              src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
                            <script
                              src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

                            <div class="modal fade" tabindex="-1" role="dialog" id="deleteModal">
                              <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <div class="modal-title">Eliminación de registro</div>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                      aria-label="Close"></button>
                                  </div>
                                  <div class="modal-body">
                                    <p>
                                      Se eliminará el registro de <b class="fw-bold">
                                        <%= notaventa.nombre %>
                                      </b><br />
                                      Estás seguro?
                                    </p>
                                  </div>
                                  <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary"
                                      data-bs-dismiss="modal">Cancelar</button>
                                    <form action="<%= notaventa._id %>?_method=DELETE" method="POST"
                                      class="position-relative">
                                      <button type="submit" class="btn btn-primary">SI, Eliminar</button>
                                    </form>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                        </div>
                      </div>


                      <!-- <div class="col-6">


                        <table class="table table-striped table-success ">
                          <thead>
                            <tr>
                              <th
                                class="text-uppercase text-primary text-xs font-weight-bolder opacity-100 ps-2 col-12">
                                </textarea>
                                Observaciones
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td class=" text-secondary text-xs font-weight-bolder text-black-100 ">
                                <textarea class="form-control" name="details" id="details" 
                                  cols="30" rows="6"><%= notaventa.details%></textarea>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group mb-4">
                  <a href="/notaventa/index" class="btn btn-info" role="button">Volver</a>
                  <button type="button" class="btn btn-danger" data-bs-toggle="modal" id="deleteButton"
                    data-bs-target="#deleteModal">Guardar</button>
                </div>
                <div class="modal fade" tabindex="-1" role="dialog" id="deleteModal">
                  <div class="modal-dialog" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <div class="modal-title">Creación de registro</div>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <p>
                          Se actualizará una nueva nota de venta <b class="fw-bold"> </b><br />
                          Estás seguro?
                        </p>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">SI, Crear</button>
          </form>
          </div>
          </div>
          </div>
          </div>
          </div> -->

                      <%- include ('../partials/_footer.ejs') %>

                    </div>
    </main>

    <div class="fixed-plugin">
      <a class="fixed-plugin-button text-dark position-fixed px-3 py-2">
        <i class="bi bi-gear-fill py-2"> </i>
      </a>
      <div class="card shadow-lg ">
        <div class="card-header pb-0 pt-3 ">
          <div class="float-start">
            <h5 class="mt-3 mb-0">Configuracion</h5>
            <p>Personaliza tu dashboard.</p>
          </div>
          <div class="float-end mt-4">
            <button class="btn btn-link text-dark p-0 fixed-plugin-close-button">
              <i class="bi bi-x-circle-fill"></i>
            </button>
          </div>
          <!-- End Toggle Button -->
        </div>
        <hr class="horizontal dark my-1">
        <div class="card-body pt-sm-3 pt-0">
          <!-- Sidebar Backgrounds -->
          <div>
            <h6 class="mb-0">Color Barra lateral</h6>
          </div>
          <a href="javascript:void(0)" class="switch-trigger background-color">
            <div class="badge-colors my-2 text-start">
              <span class="badge filter bg-gradient-primary active" data-color="primary"
                onclick="sidebarColor(this)"></span>
              <span class="badge filter bg-gradient-dark" data-color="dark" onclick="sidebarColor(this)"></span>
              <span class="badge filter bg-gradient-info" data-color="info" onclick="sidebarColor(this)"></span>
              <span class="badge filter bg-gradient-success" data-color="success" onclick="sidebarColor(this)"></span>
              <span class="badge filter bg-gradient-warning" data-color="warning" onclick="sidebarColor(this)"></span>
              <span class="badge filter bg-gradient-danger" data-color="danger" onclick="sidebarColor(this)"></span>
            </div>
          </a>
          <!-- Sidenav Type -->
          <div class="mt-3">
            <h6 class="mb-0">Tipo de barra lateral</h6>
            <p class="text-sm">Selecciona un tipo de barra</p>
          </div>
          <div class="d-flex">
            <button class="btn bg-gradient-primary w-100 px-3 mb-2 active" data-class="bg-transparent"
              onclick="sidebarType(this)">Transparente</button>
            <button class="btn bg-gradient-primary w-100 px-3 mb-2 ms-2" data-class="bg-white"
              onclick="sidebarType(this)">Blanco</button>
          </div>
          <p class="text-sm d-xl-none d-block mt-2"></p>
          <!-- Navbar Fixed -->
          <div class="mt-3">
            <h6 class="mb-0">Barra superior fija</h6>
          </div>
          <div class="form-check form-switch ps-0">
            <input class="form-check-input mt-1 ms-auto" type="checkbox" id="navbarFixed" onclick="navbarFixed(this)">
          </div>
          <!-- <hr class="horizontal dark my-sm-4">
    <a class="btn bg-gradient-dark w-100" href="https://www.creative-tim.com/product/soft-ui-dashboard">Free Download</a>
    <a class="btn btn-outline-dark w-100" href="https://www.creative-tim.com/learning-lab/bootstrap/license/soft-ui-dashboard">View documentation</a>
    <div class="w-100 text-center">
      <a class="github-button" href="https://github.com/creativetimofficial/soft-ui-dashboard" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star creativetimofficial/soft-ui-dashboard on GitHub">Star</a>
      <h6 class="mt-3">Thank you for sharing!</h6>
      <a href="https://twitter.com/intent/tweet?text=Check%20Soft%20UI%20Dashboard%20made%20by%20%40CreativeTim%20%23webdesign%20%23dashboard%20%23bootstrap5&amp;url=https%3A%2F%2Fwww.creative-tim.com%2Fproduct%2Fsoft-ui-dashboard" class="btn btn-dark mb-0 me-2" target="_blank">
        <i class="fab fa-twitter me-1" aria-hidden="true"></i> Tweet
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.creative-tim.com/product/soft-ui-dashboard" class="btn btn-dark mb-0 me-2" target="_blank">
        <i class="fab fa-facebook-square me-1" aria-hidden="true"></i> Share
      </a>
    </div>-->
        </div>
      </div>
    </div>
    <div id="datos">
    </div>
    <div id="datos">
    </div>

    <!--   Core JS Files   -->
    <script src="../js/core/popper.min.js"></script>
    <script src="../js/core/bootstrap.min.js"></script>
    <script src="../js/plugins/perfect-scrollbar.min.js"></script>
    <script src="../js/plugins/smooth-scrollbar.min.js"></script>
    <script src="../js/plugins/chartjs.min.js"></script>
    <script src="/js/Sortable.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
      integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"
      integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2XofN4zfuZxLkoj1gXtW8ANNCe9d5Y3eG5eD"
      crossorigin="anonymous"></script>


    <script type="text/javascript">
      window.onload = function () {
        renderizardatosPDF()
        actualizardatosPDF()
        actualizarindicator()
        updatelink()
        actualizaritem()
        actualizarplapagotabla()
        actualizarplanentregatabla()
        actualizarfacturatabla()
        actualizarcobrotabla()
        actualizarentregatabla()
        actualizararchivos();
        if (document.cookie.includes(window.location.href)) {
          if (document.cookie.match(/scrollTop=([^;]+)(;|$)/) != null) {
            var arr = document.cookie.match(/scrollTop=([^;]+)(;|$)/);
            document.documentElement.scrollTop = parseInt(arr[1]);
            document.body.scrollTop = parseInt(arr[1]);
          }
        }
      }

      function notasvisible() {
        document.getElementById("notasinvisible").hidden = true;
        document.getElementById("notasvisible").hidden = false;
        document.getElementById("notasvisible1").hidden = false;
      }

      function notasinvisible() {
        document.getElementById("notasinvisible").hidden = false;
        document.getElementById("notasvisible").hidden = true;
        document.getElementById("notasvisible1").hidden = true;
      }

      function adaptacionvisible(i) {
    
        document.getElementById("adaptacion_up_" + i).hidden = false;
        document.getElementById("adaptacion_down_" + i).hidden = true;
        document.getElementById("adaptacion_" + i).hidden = false;
        document.getElementById("adaptacion1_" + i).hidden = false;
        document.getElementById("adaptacion2_" + i).hidden = false;
      }

      function adaptacioninvisible(i) {
        document.getElementById("adaptacion_up_" + i).hidden = true;
        document.getElementById("adaptacion_down_" + i).hidden = false;
        document.getElementById("adaptacion_" + i).hidden = true;
        document.getElementById("adaptacion1_" + i).hidden = true;
        document.getElementById("adaptacion2_" + i).hidden = true;
      }

      function retrabajovisible(i) {
    
        document.getElementById("retrabajo_up_" + i).hidden = false;
        document.getElementById("retrabajo_down_" + i).hidden = true;
        document.getElementById("retrabajo_" + i).hidden = false;
        document.getElementById("retrabajo1_" + i).hidden = false;
        document.getElementById("retrabajo2_" + i).hidden = false;
      }

      function retrabajoinvisible(i) {
        document.getElementById("retrabajo_up_" + i).hidden = true;
        document.getElementById("retrabajo_down_" + i).hidden = false;
        document.getElementById("retrabajo_" + i).hidden = true;
        document.getElementById("retrabajo1_" + i).hidden = true;
        document.getElementById("retrabajo2_" + i).hidden = true;
      }
      function desviacionvisible(i) {
      
        document.getElementById("desviacion_up_" + i).hidden = false;
        document.getElementById("desviacion_down_" + i).hidden = true;
        document.getElementById("desviacion_" + i).hidden = false;
        document.getElementById("desviacion1_" + i).hidden = false;
        document.getElementById("desviacion2_" + i).hidden = false;
      }

      function desviacioninvisible(i) {
        document.getElementById("desviacion_up_" + i).hidden = true;
        document.getElementById("desviacion_down_" + i).hidden = false;
        document.getElementById("desviacion_" + i).hidden = true;
        document.getElementById("desviacion1_" + i).hidden = true;
        document.getElementById("desviacion2_" + i).hidden = true;
      }


      function readSingleFile(e) {
        const name = e[0].name;
        document.getElementById("file-label").textContent = name;
      }

      //PLAN DE PAGO/////////////////////////////////////////////////
      //PLAN DE PAGO/////////////////////////////////////////////////
      //PLAN DE PAGO/////////////////////////////////////////////////
      //PLAN DE PAGO/////////////////////////////////////////////////
      function agregarpago() {
   
        let planpago = document.getElementById("planpago").value;
        if (planpago == "") { planpago = planpago + "concepto,0,0,2023-01-01" }
        else {
          planpago = planpago + ";concepto,0,0,2023-01-01" + ",,,,,,"
        }
        document.getElementById("planpago").value = planpago
        actualizarplapagotabla()

      }

      function actualizarplapagotabla() {
       
        let planpago = document.getElementById("planpago").value;
        let precioventa = document.getElementById("precioventa").value;
        let numero01 = document.getElementById("numero01").value;
        let text = ""
        let text_solovista = ""
        let text1 = ""
        let text1_solovista = ""
        porc1 = 0
        porc2 = 0
        porc = ""

        let arrplanpago = String(planpago).split(';');

        document.getElementById("planpagocant").value = arrplanpago.length
      
        for (i = 0; i < arrplanpago.length; i++) {
          let arr = String(arrplanpago[i]).split(',');
          text1 = '<tr><td> <input id="planpagoconcepto_' + i + '" type="text" value="' + arr[0] + '" onchange="actualizarplanpago() ">'
          text1 = text1 + '<td> <input id="planpagoporcentaje1_' + i + '" type="number" step="0.001" min="0" value="' + arr[1] + '" onchange="actualizarplanpago() ">'
          text1 = text1 + '<td> <input id="planpagoporcentaje2_' + i + '" type="number" step="0.001" min="0" value="' + arr[2] + '" onchange="actualizarplanpago() ">'
          text1 = text1 + '<td> <input id="planpagofecha_' + i + '" type="text" value="' + arr[3] + '" onchange="actualizarplanpago() ">'
          text1 = text1 + '<td> <p>' + precioventa * arr[1]/100 + '</p></td>'
          text1 = text1 + '<td> <p>' + numero01 * arr[2] /100+ '</p></td>'
          text1 = text1 + '<td> <buttom onclick="eliminarplanpago(' + i + ')"> <i class="bi bi-trash"></i> </buttom></td></tr>'
          text = text + text1

          text1_solovista = '<tr><td> <input disabled id="planpagoconcepto_' + i + '" type="text" value="' + arr[0] + '" onchange="actualizarplanpago() ">'
            text1_solovista = text1_solovista + '<td> <input disabled id="planpagoporcentaje1_' + i + '" type="number" step="0.001" min="0" value="' + arr[1] + '" onchange="actualizarplanpago() ">'
              text1_solovista = text1_solovista + '<td> <input disabled id="planpagoporcentaje2_' + i + '" type="number" step="0.001" min="0" value="' + arr[2] + '" onchange="actualizarplanpago() ">'
                text1_solovista = text1_solovista + '<td> <input disabled id="planpagofecha_' + i + '" type="text" value="' + arr[3] + '" onchange="actualizarplanpago() ">'
                  text1_solovista = text1_solovista + '<td> <p>' + precioventa * arr[1]/100 + '</p></td>'
                  text1_solovista = text1_solovista + '<td> <p>' + numero01 * arr[2] /100+ '</p></td>'
                  text1_solovista = text1_solovista + '<td> </td></tr>'
          text_solovista = text_solovista + text1_solovista

          porc1 = porc1 + parseFloat(arr[1])
          porc2 = porc2 + parseFloat(arr[2])
         
        }
        if (porc1 != 100) porc = "NO SUMAN 100% a"
        if (porc2 != 100) porc = "NO SUMAN 100% b"
        text = text + ' <tr><td></td><td>' + porc1 + '   </td><td>' + porc2 + '   </td> <td>' + porc + '   </td><tr>'
          text_solovista = text_solovista + ' <tr><td></td><td>' + porc1 + '   </td><td>' + porc2 + '   </td> <td>' + porc + '   </td><tr>'
          document.getElementById("planpagotabla").innerHTML = text
        document.getElementById("planpagotabla-solovista").innerHTML = text_solovista
      }

      function actualizarplanpago() {
       
        let text = ""
        let cant = document.getElementById("planpagocant").value
     
        for (i = 0; i < cant; i++) {
          if (i != 0) { text = text + ";" }
          let a = document.getElementById("planpagoconcepto_" + i).value
          let b = document.getElementById("planpagoporcentaje1_" + i).value
          let c = document.getElementById("planpagoporcentaje2_" + i).value
          let d = document.getElementById("planpagofecha_" + i).value
          text = text + a + "," + b + "," + c + "," + d + ",,,,,,"
        }
        document.getElementById("planpago").value = text
        actualizarplapagotabla()

      }

      function eliminarplanpago(a) {
        let borrararchivo = confirm("¿Desea eliminar item del plan de pago?");
        let fecha = document.getElementById("fechaentrega").value
        let text = ""
        let text1 = ""
        let cant = document.getElementById("planpagocant").value
  
        if (cant == 1) { text = ",0,0," + fecha + ",,,,,," }
        else {
          ii = 0
          for (i = 0; i < cant; i++) {
            if (i != a) {
              if (ii != 0) { text = text + ";" }
              let a = document.getElementById("planpagoconcepto_" + i).value
              let b = document.getElementById("planpagoporcentaje1_" + i).value
              let c = document.getElementById("planpagoporcentaje2_" + i).value
              let d = document.getElementById("planpagofecha_" + i).value
              text = text + a + "," + b + "," + c + "," + d + ",,,,,,"
              ii++
            }
          }
        }
        document.getElementById("planpago").value = text
        actualizarplapagotabla()

      }

      //PLAN DE ENTREGA/////////////////////////////////////////////////
      //PLAN DE ENTREGA/////////////////////////////////////////////////
      //PLAN DE ENTREGA/////////////////////////////////////////////////
      //PLAN DE ENTREGA/////////////////////////////////////////////////
      function agregarentrega() {
     
        let planentrega = document.getElementById("planentrega").value;
        if (planentrega == "") { planentrega = planentrega + "concepto,0,2023-01-01" }
        else {
          planentrega = planentrega + ";concepto,0,2023-01-01" + ",,,,,,"
        }
        document.getElementById("planentrega").value = planentrega
        actualizarplanentregatabla()

      }

      function actualizarplanentregatabla() {
      
        let planentrega = document.getElementById("planentrega").value;

        let text = ""
        let text_solovista = ""
        let text1 = ""
        let text1_solovista = ""

        porc1 = 0

        porc = ""

        let arrplanentrega = String(planentrega).split(';');

        document.getElementById("planentregacant").value = arrplanentrega.length
      
        for (i = 0; i < arrplanentrega.length; i++) {
          let arr = String(arrplanentrega[i]).split(',');
          text1 = '<tr><td> <input id="planentregaconcepto_' + i + '" type="text" value="' + arr[0] + '" onchange="actualizarplanentrega() ">'
          text1 = text1 + '<td> <input id="planentregaporcentaje1_' + i + '" type="number" step="0.001" min="0" value="' + arr[1] + '" onchange="actualizarplanentrega() ">'

          text1 = text1 + '<td> <input id="planentregafecha_' + i + '" type="text" value="' + arr[2] + '" onchange="actualizarplanentrega() ">'

          text1 = text1 + '<td> <buttom onclick="eliminarplanentrega(' + i + ')"> <i class="bi bi-trash"></i> </buttom></td></tr>'
          text = text + text1

          text1_solovista = '<tr><td> <input disabled id="planentregaconcepto_' + i + '" type="text" value="' + arr[0] + '" onchange="actualizarplanentrega() ">'
          text1_solovista = text1_solovista + '<td> <input disabled id="planentregaporcentaje1_' + i + '" type="number" step="0.001" min="0" value="' + arr[1] + '" onchange="actualizarplanentrega() ">'

          text1_solovista = text1_solovista + '<td> <input disabled id="planentregafecha_' + i + '" type="text" value="' + arr[2] + '" onchange="actualizarplanentrega() ">'

          text1_solovista = text1_solovista + '<td> </td></tr>'
          text_solovista = text_solovista + text1_solovista
          porc1 = porc1 + parseFloat(arr[1])

         

        }
        if (porc1 != 100) porc = "NO SUMAN 100% a"

        text = text + ' <tr><td></td><td>' + porc1 + '   </td> <td>' + porc + '   </td><tr>'
        document.getElementById("planentregatabla").innerHTML = text
        text_solovista = text_solovista + ' <tr><td></td><td>' + porc1 + '   </td> <td>' + porc + '   </td><tr>'
          document.getElementById("planentregatabla_solovista").innerHTML = text_solovista
      }

      function actualizarplanentrega() {
        
        let text = ""
        let cant = document.getElementById("planentregacant").value
       
        for (i = 0; i < cant; i++) {
          if (i != 0) { text = text + ";" }
          let a = document.getElementById("planentregaconcepto_" + i).value
          let b = document.getElementById("planentregaporcentaje1_" + i).value
          let d = document.getElementById("planentregafecha_" + i).value
          text = text + a + "," + b + "," + d + ",,,,,,"
        }
        document.getElementById("planentrega").value = text
        actualizarplanentregatabla()
      }

      function eliminarplanentrega(a) {
        let borrararchivo = confirm("¿Desea eliminar item del plan de entrega?");
        let fecha = document.getElementById("fechaentrega").value
        let text = ""
        let text1 = ""
        let cant = document.getElementById("planentregacant").value
      
        if (cant == 1) { text = ",0," + fecha + ",,,,,," }
        else {
          ii = 0
          for (i = 0; i < cant; i++) {
            if (i != a) {
              if (ii != 0) { text = text + ";" }
              let a = document.getElementById("planentregaconcepto_" + i).value
              let b = document.getElementById("planentregaporcentaje1_" + i).value
              let d = document.getElementById("planentregafecha_" + i).value
              text = text + a + "," + b + "," + d + ",,,,,,"
              ii++
            }
          }
        }
        document.getElementById("planentrega").value = text
        actualizarplanentregatabla()
      }


      //FACTURACION/////////////////////////////////////////////////
      //FACTURACION/////////////////////////////////////////////////
      //FACTURACION/////////////////////////////////////////////////
      //FACTURACION/////////////////////////////////////////////////
      function agregarfactura() {
     
        let factura = document.getElementById("factura").value;
        if (factura == "") { factura = factura + "A,0,0,0,0,0," }
        else {
          factura = factura + ";A,0,0,0,0,0,"
        }
        document.getElementById("factura").value = factura
        actualizarfacturatabla()
      }

      function actualizarfacturatabla() {
       
        let factura = document.getElementById("factura").value;
 
        let precioventa = document.getElementById("precioventa").value;
        let text = ""
        let text1 = ""
         let text_solovista = ""
        let text1_solovista = ""
        puntoventa = 0
        numerofactura = 0
        montop = 0
        montou = 0
        iva = ""
        let monto1 = 0
        porc = ""
        let color = ""
        let arrfactura = String(factura).split(';');
        document.getElementById("facturacant").value = arrfactura.length
        idnv=document.getElementById("idnv").innerHTML
        let permiso=document.getElementById('tipousuario').value


        for (i = 0; i < arrfactura.length; i++) {
          text1=""
          text1_solovista=""
          let arr = String(arrfactura[i]).split(',');
          console.log('factura i '+i+'--'+arr)
          text1 = text1 + '<tr><td> <input disabled id="factuaraId_' + i + '"type="text" value="F' +idnv +'-' +i+ '"  > </td>'
          text1 = text1 +'<td> <input  size="3" id="facturatipo_' + i + '" type="text" value="' + arr[0] + '" onchange="actualizarfactura() ">'
          text1 = text1 + '-<select  id="iva_' + i + '" onchange="actualizarfactura() "> <option value="' + arr[5] + '"> '+arr[5] +'</option> <option value="21 %">21 %</option><option value="10.5 %">10.5 %</option> <option value="27 %">27 %</option> <option value="2.5 %">2.5 %</option></select> </td> '                                             
          text1 = text1 + '<td> <input  size="3" id="puntoventa_' + i + '" type="number" step="0.001" min="0" value="' + arr[1] + '" onchange="actualizarfactura() ">'
          text1 = text1 + '-<input width="20px" id="numerofactura_' + i + '" type="number" step="0.001" min="0" value="' + arr[2] + '" onchange="actualizarfactura() "> </td>'
          text1 = text1 + '<td> <input size="5" id="montop_' + i + '" type="number" step="0.001" min="0" value="' + arr[3] + '" onchange="actualizarfactura() ">'
          text1 = text1 + '-<input size="5" id="montou_' + i + '" type="number" step="0.001" min="0" value="' + arr[4] + '" onchange="actualizarfactura() "> </td>'
           text1 = text1 + '<td> <input size="10" id="facturafecha_' + i + '" type="text" value="' + arr[6] + '" onchange="actualizarfactura() ">'
          text1 = text1 + '<td> <input id="nota_' + i + '" type="text" value="' + arr[7] + '" onchange="actualizarfactura() ">'
         if(permiso=='SIS'){
          text1 = text1 + '<td> <buttom onclick="eliminarfactura(' + i + ')"> <i class="bi bi-trash"></i> </buttom></td>'
        
         }else{
          text1 = text1 + '<td> </td>'
         }
         text1 = text1 + '<td id="archivofactura_'+i+'">------</td> </tr>'
            text = text + text1

          text1_solovista = text1_solovista + '<tr><td> <input disabled type="text" value="F' +idnv +'-' +i+ '"  > </td>'
          text1_solovista = text1_solovista +'<td> <input disabled size="3"  type="text" value="' + arr[0] + '" onchange="actualizarfactura() ">'
          text1_solovista = text1_solovista + '-<select  disabled onchange="actualizarfactura() "> <option value="' + arr[5] + '"> '+arr[5] +'</option> <option value="21 %">21 %</option><option value="10.5 %">10.5 %</option> <option value="27 %">27 %</option> <option value="2.5 %">2.5 %</option></select> </td> '                                             
          text1_solovista = text1_solovista + '<td> <input disabled size="3"  type="number" step="0.001" min="0" value="' + arr[1] + '" onchange="actualizarfactura() ">'
          text1_solovista = text1_solovista + '-<input disabled width="20px"  type="number" step="0.001" min="0" value="' + arr[2] + '" onchange="actualizarfactura() "> </td>'
          text1_solovista = text1_solovista + '<td> <input disabled size="5"  type="number" step="0.001" min="0" value="' + arr[3] + '" onchange="actualizarfactura() ">'
          text1_solovista = text1_solovista + '-<input disabled size="5"  type="number" step="0.001" min="0" value="' + arr[4] + '" onchange="actualizarfactura() "> </td>'
           text1_solovista = text1_solovista + '<td> <input disabled size="10"  type="text" value="' + arr[6] + '" onchange="actualizarfactura() ">'
          text1_solovista = text1_solovista + '<td> <input disabled type="text" value="' + arr[7] + '" onchange="actualizarfactura() ">'
          text1_solovista = text1_solovista + '<td></td>'
          text1_solovista = text1_solovista + '<td id="archivofacturasolovista_'+i+'">------</td> </tr>'     
          text_solovista = text_solovista + text1_solovista
          monto1 = monto1 + parseFloat(arr[4])

        }
        
        if (monto1 == precioventa) {
          porc = "COMPLETA"
          color = "background-color:greenyellow;"
        }
        else {
          porc = "INCOMPLETA"
          color = "background-color:tomato;"
        }

        text = text + ' <tr ><td></td><td>  </td><td>  </td><td><div class="row"> <div class="col-6"> </div> <div class="col-6" id="facturares"> ' + monto1 + '</div></div></td><td>' + porc + '   </td><tr>'
        text_solovista = text_solovista + ' <tr ><td></td><td>  </td><td>  </td><td><div class="row"> <div class="col-6"> </div> <div class="col-6" id="facturares_solovista"> ' + monto1 + '</div></div></td><td>' + porc + '   </td><tr>'
        document.getElementById("facturatabla").innerHTML = text
        document.getElementById("facturatabla_solovista").innerHTML = text_solovista
        document.getElementById("facturares").style = color
        document.getElementById("facturares_solovista").style = color
        let resumen=document.getElementById("string08").value
        arrresumen=resumen.split(",")
        let porcentaje=0
        if (precioventa==0)
         {porcentaje=100}
         else{
        porcentaje=(parseInt(monto1/precioventa*1000))/10
         }
      
        for(i=0;i<6;i++){
          if (arrresumen[i]==undefined){arrresumen[i]=0}
        }
        resumen=porcentaje+","+arrresumen[1]+","+arrresumen[2]+","+arrresumen[3]+","+arrresumen[4]+","+arrresumen[5]
        document.getElementById("string08").value=resumen
      }

      function actualizarfactura() {
        let text = ""
        let cant = document.getElementById("facturacant").value 
        for (i = 0; i < cant; i++) {
          if (i != 0) { text = text + ";" }
          let a = document.getElementById("facturatipo_" + i).value
          let b = document.getElementById("puntoventa_" + i).value
          let c = document.getElementById("numerofactura_" + i).value
          let d = document.getElementById("montop_" + i).value
          let e = document.getElementById("montou_" + i).value
          let h = document.getElementById("iva_" + i).value
          let f = document.getElementById("facturafecha_" + i).value
          let g = document.getElementById("nota_" + i).value
          text = text + a + "," + b + "," + c + "," + d + "," + e + ","+ h + "," + f + "," + g + ",,,,,,"
        }
        document.getElementById("factura").value = text
        actualizarfacturatabla()

      }

      function eliminarfactura(a) {
        let borrararchivo = confirm("¿Desea eliminar factura?");
        let text = ""
        let text1 = ""
        let cant = document.getElementById("facturacant").value
    

        if (cant == 1) { text = ",,,0,0,,,,,,,," }
        else {
          ii = 0
          for (i = 0; i < cant; i++) {
            if (i != a) {
              if (ii != 0) { text = text + ";" }
              let a = document.getElementById("facturatipo_" + i).value
              let b = document.getElementById("puntoventa_" + i).value
              let c = document.getElementById("numerofactura_" + i).value
              let d = document.getElementById("montop_" + i).value
              let e = document.getElementById("montou_" + i).value
              let h = document.getElementById("iva_" + i).value
              let f = document.getElementById("facturafecha_" + i).value
              let g = document.getElementById("nota_" + i).value
              text = text + a + "," + b + "," + c + "," + d + "," + e + ","+ h + "," + f + "," + g + ",,,,,,"
              ii++
            }
          }
        }
        document.getElementById("factura").value = text
        actualizarfacturatabla()

      }

      //COBRANZA/////////////////////////////////////////////////
      //COBRANZA/////////////////////////////////////////////////
      //COBRANZA/////////////////////////////////////////////////
      //COBRANZA/////////////////////////////////////////////////


      function agregarcobro() {

        let cobro = document.getElementById("cobro").value;
        if (cobro == "") { cobro = cobro + ",,,0,0,0,0,,0,''" + + ",,,,,," }
        else {
          cobro = cobro + ";,,,0,0,0,0,,," + + ",,,,,,"
        }
        document.getElementById("cobro").value = cobro
        actualizarcobrotabla()

      }

      function actualizarcobrotabla() {
  
        let cobro = document.getElementById("cobro").value;
        let precioventa1 = document.getElementById("precioventa").value;
        let precioventa2 = document.getElementById("numero01").value;
        let text = ""
        let text1 = ""
         let text_solovista = ""
        let text1_solovista = ""
        puntoventa = 0
        numerofactura = 0
        monto1p = 0
        monto1u = 0
        monto2p = 0
        monto2u = 0
        let monto1 = 0
        let monto2 = 0
        porc1 = ""
        porc2 = ""
        let color = ""
        let arrcobro = String(cobro).split(';');
        let permiso=document.getElementById('tipousuario').value
        document.getElementById("cobrocant").value = arrcobro.length
        idnv=document.getElementById("idnv").innerHTML
        
        for (i = 0; i < arrcobro.length; i++) {
          let arr = String(arrcobro[i]).split(',');
          text1=""
          text1_solovista=""
          text1 =  '<tr><td> <input size="8" disabled id="entregaremitoelectronico_' + i + '"type="text" value="C' +idnv +'-'+i + '"  > </td>'
          text1 = text1 +'<td>  <select id="cobromedio_' + i + '" onchange="actualizarcobro() "> <option value="' + arr[0] + '"> ' + arr[0] + '</option>  <option value="Efectivo">Efectivo</option>   <option value="Cheque Elec.">Cheque Elec.</option><option value="Cheque Físico.">Cheque Físico.</option><option value="Transf.Banc.">Transf.Banc.</option><option value="Otro">Otro</option>  </select> </td>'
          text1 = text1 + '<td> <input id="cobropuntoventa_' + i + '" type="number" step="0.001" min="0" value="' + arr[1] + '" onchange="actualizarcobro() ">'
          text1 = text1 + ' <input id="cobronumerofactura_' + i + '" type="number" step="0.001" min="0" value="' + arr[2] + '" onchange="actualizarcobro() "></td>'
          text1 = text1 + '<td> <input id="cobromonto1p_' + i + '" type="number" step="0.001" min="0" value="' + arr[3] + '" onchange="actualizarcobro() ">'
          text1 = text1 + ' <input id="cobromonto1u_' + i + '" type="number" step="0.001" min="0" value="' + arr[4] + '" onchange="actualizarcobro()"> </td>'
          text1 = text1 + '<td> <input id="cobromonto2p_' + i + '" type="number" step="0.001" min="0" value="' + arr[5] + '"onchange="actualizarcobro() ">'
          text1 = text1 + ' <input id="cobromonto2u_' + i + '" type="number" step="0.001" min="0" value="' + arr[6] + '" onchange="actualizarcobro() "> </td>'
          text1 = text1 + '<td> <input id="cobrofecha_' + i + '" type="text" value="' + arr[7] + '" onchange="actualizarcobro() ">'
          text1 = text1 + '<input id="cobrodiferido_' + i + '" type="text" value="' + arr[8] + '" onchange="actualizarcobro() "> </td>'
          text1 = text1 + '<td> <input id="cobronota_' + i + '" type="text" value="' + arr[9] + '"onchange="actualizarcobro()">'
            if(permiso=='SIS'){
          text1 = text1 + '<td> <buttom onclick="eliminarcobro(' + i + ')"> <i class="bi bi-trash"></i> </buttom></td>'
        
         }else{
          text1 = text1 + '<td> </td>'
         }
          text1 = text1 + '<td id="archivocobro_'+i+'">------</td> </tr>'
          
             text = text + text1

          text1_solovista =  '<tr><td> <input size="8" disabled id="entregaremitoelectronico_' + i + '"type="text" value="R' +idnv +'-'+i + '"  > </td>'
          text1_solovista = text1_solovista +'<td>  <select  disabled  onchange="actualizarcobro() "> <option value="' + arr[0] + '"> ' + arr[0] + '</option>  <option value="Efectivo">Efectivo</option>   <option value="Cheque Elec.">Cheque Elec.</option><option value="Cheque Físico.">Cheque Físico.</option><option value="Transf.Banc.">Transf.Banc.</option><option value="Otro">Otro</option>  </select> </td>'
          text1_solovista = text1_solovista + '<td> <input  disabled  type="number" step="0.001" min="0" value="' + arr[1] + '" onchange="actualizarcobro() ">'
          text1_solovista = text1_solovista + ' <input  disabled  type="number" step="0.001" min="0" value="' + arr[2] + '" onchange="actualizarcobro() "></td>'
          text1_solovista = text1_solovista + '<td> <input  disabled  type="number" step="0.001" min="0" value="' + arr[3] + '" onchange="actualizarcobro() ">'
          text1_solovista = text1_solovista + ' <input  disabled  type="number" step="0.001" min="0" value="' + arr[4] + '" onchange="actualizarcobro()"> </td>'
          text1_solovista = text1_solovista + '<td> <input disabled   type="number" step="0.001" min="0" value="' + arr[5] + '"onchange="actualizarcobro() ">'
          text1_solovista = text1_solovista + ' <input  disabled  type="number" step="0.001" min="0" value="' + arr[6] + '" onchange="actualizarcobro() "> </td>'
          text1_solovista = text1_solovista + '<td> <input  disabled  type="text" value="' + arr[7] + '" onchange="actualizarcobro() ">'
          text1_solovista = text1_solovista + '<input  disabled  type="text" value="' + arr[8] + '" onchange="actualizarcobro() "> </td>'
          text1_solovista = text1_solovista + '<td> <input  disabled  type="text" value="' + arr[9] + '"onchange="actualizarcobro()">'
          text1_solovista = text1_solovista + '<td> </td>'
           text1_solovista = text1_solovista + '<td id="archivocobrosolovista_'+i+'">------</td> </tr>'
          text_solovista = text_solovista + text1_solovista
          monto1 = monto1 + parseFloat(arr[4])
          monto2 = monto2 + parseFloat(arr[6])
       
        }
        if (monto1 == precioventa1) {
          porc1 = "COMPLETA"
          color1 = "background-color:greenyellow;"
        }
        else {
          porc1 = "INCOMPLETA"
          color1 = "background-color:tomato;"
        }
        if (monto2 == precioventa2) {
          porc2 = "COMPLETA"
          color2 = "background-color:greenyellow;"
        }
        else {
          porc2 = "INCOMPLETA"
          color2 = "background-color:tomato;"  
        }
        text = text + ' <tr ><td></td><td>   </td><td>   </td><td   ><div class="row"> <div class="col-6">'+ porc1 +' </div> <div class="col-6" id="cobrores1">' + monto1 + '</div>  </div>    </td> <td  ><div class="row"> <div class="col-6">'+ porc2 +' </div> <div class="col-6" id="cobrores2">' + monto2 + ' <div>  </td> <td >   </td><td >   </td><tr>'
        text_solovista = text_solovista + '  <tr ><td></td><td>   </td><td>   </td><td   ><div class="row"> <div class="col-6">'+ porc1 +' </div> <div class="col-6" id="cobrores1_solovista">' + monto1 + '</div>  </div>    </td> <td  ><div class="row"> <div class="col-6">'+ porc2 +' </div> <div class="col-6" id="cobrores2_solovista">' + monto2 + ' <div>  </td> <td >   </td><td >   </td><tr>'
        document.getElementById("cobrotabla").innerHTML = text
        document.getElementById("cobrotabla_solovista").innerHTML = text_solovista
        document.getElementById("cobrores1").style = color1
        document.getElementById("cobrores2").style = color2
        document.getElementById("cobrores1_solovista").style = color1
        document.getElementById("cobrores2_solovista").style = color2

        let resumen=document.getElementById("string08").value
        arrresumen=resumen.split(",")
        for(i=0;i<6;i++){
          if (arrresumen[i]==undefined){arrresumen[i]=0}
        }
        let porcentaje1=0
        let porcentaje2=0
        if (precioventa1==0)
         {porcentaje1=100}
         else{
        porcentaje1=(parseInt(monto1/precioventa1*1000))/10
         }
         if (precioventa2==0)
         {porcentaje2=100}
         else{
        porcentaje2=(parseInt(monto2/precioventa2*1000))/10
         }
       
        resumen=arrresumen[0]+","+porcentaje1+","+porcentaje2+","+arrresumen[3]+","+arrresumen[4]+","+arrresumen[5]
        document.getElementById("string08").value=resumen



      }

      function actualizarcobro() {
      
        let text = ""

        let cant = document.getElementById("cobrocant").value

        for (let i = 0; i < cant; i++) {
       

          if (i != 0) { text = text + ";" }
          let a = document.getElementById("cobromedio_" + i).value
          let b = document.getElementById("cobropuntoventa_" + i).value
          let c = document.getElementById("cobronumerofactura_" + i).value
          let d = document.getElementById("cobromonto1p_" + i).value
          let e = document.getElementById("cobromonto1u_" + i).value
          let f = document.getElementById("cobromonto2p_" + i).value
          let g = document.getElementById("cobromonto2u_" + i).value
          let h = document.getElementById("cobrofecha_" + i).value
          let j = document.getElementById("cobrodiferido_" + i).value
          let k = document.getElementById("cobronota_" + i).value
          text = text + a + "," + b + "," + c + "," + d + "," + e + "," + f + "," + g + "," + h + "," + j + "," + k + ",,,,,,"
        }
        document.getElementById("cobro").value = text
        actualizarcobrotabla()

      }

      function eliminarcobro(a) {
        let borrararchivo = confirm("¿Desea eliminar registro de cobro?");
        let text = ""
        let text1 = ""
        let cant = document.getElementById("cobrocant").value
      
        if (cant == 1) { text = ",,,0,0,0,0,," + ",,,,,," }
        else {
          ii = 0
          for (i = 0; i < cant; i++) {
            if (i != a) {
              if (ii != 0) { text = text + ";" }
              let a = document.getElementById("cobromedio_" + i).value
              let b = document.getElementById("cobropuntoventa_" + i).value
              let c = document.getElementById("cobronumerofactura_" + i).value
              let d = document.getElementById("cobromonto1p_" + i).value
              let e = document.getElementById("cobromonto1u_" + i).value
              let f = document.getElementById("cobromonto2p_" + i).value
              let g = document.getElementById("cobromonto2u_" + i).value
              let h = document.getElementById("cobrofecha_" + i).value
              let j = document.getElementById("cobrodiferido_" + i).value
              let k = document.getElementById("cobronota_" + i).value
              text = text + a + "," + b + "," + c + "," + d + "," + e + "," + f + "," + g + "," + h + "," + j + "," + k + ",,,,,,"
              ii++
            }
          }
        }
        document.getElementById("cobro").value = text
        actualizarcobrotabla()
      }
 
      //ENTREGA/////////////////////////////////////////////////
      //ENTREGA/////////////////////////////////////////////////
      //ENTREGA/////////////////////////////////////////////////
      //ENTREGA/////////////////////////////////////////////////


    //  editarentrega_  cerrarentrega_ edicionremito btneditremito btnofineditremito
    function editarentrega(i) { 
         
          document.getElementById("btneditremito_"+i).hidden=true;  
          document.getElementById("btnofineditremito_"+i).hidden=false;   
          document.getElementById("cabtabla1_"+i).hidden=false;  
          document.getElementById("cabtabla2_"+i).hidden=false; 
          document.getElementById("cabtabla3_"+i).hidden=false; 
          document.getElementById("cabtabla4_"+i).hidden=false; 
          document.getElementById("cabtabla5_"+i).hidden=false; 
          document.getElementById("cabtabla6_"+i).hidden=false;
          document.getElementById("cabtabla7_"+i).hidden=false; 
          document.getElementById("cabtabla8_"+i).hidden=false; 
          document.getElementById("cabtabla9_"+i).hidden=false; 
          // document.getElementById("cabtabla10_"+i).hidden=false; 
          document.getElementById("cabtabla11_"+i).hidden=false; 
          document.getElementById("cabtabla12_"+i).hidden=false; 
          document.getElementById("cabtabla13_"+i).hidden=false; 
          document.getElementById("cabtabla14_"+i).hidden=false; 
          document.getElementById("cabtabla15_"+i).hidden=false; 
          document.getElementById("cabtabla16_"+i).hidden=false; 
          document.getElementById("cabtabla17_"+i).hidden=false; 
          document.getElementById("cabtabla18_"+i).hidden=false; 



          let itemagregadocant=document.getElementById("itemagregadocant").value
          let cantitem=itemagregadocant.split(',')
          for (j=0;j<cantitem.length-1;j++){
            document.getElementById("edicionremito_"+i+"_"+j).hidden=false;    
          }
        
        }

          function cerrarentrega(i) { 
          document.getElementById("btneditremito_"+i).hidden=false;  
          document.getElementById("btnofineditremito_"+i).hidden=true;  
          document.getElementById("cabtabla1_"+i).hidden=true;  
          document.getElementById("cabtabla2_"+i).hidden=true; 
          document.getElementById("cabtabla3_"+i).hidden=true; 
          document.getElementById("cabtabla4_"+i).hidden=true; 
          document.getElementById("cabtabla5_"+i).hidden=true; 
          document.getElementById("cabtabla6_"+i).hidden=true;   
          
          document.getElementById("cabtabla7_"+i).hidden=true; 
          document.getElementById("cabtabla8_"+i).hidden=true; 
          document.getElementById("cabtabla9_"+i).hidden=true;
          // document.getElementById("cabtabla10_"+i).hidden=true; 
          document.getElementById("cabtabla11_"+i).hidden=true; 
          document.getElementById("cabtabla12_"+i).hidden=true;
          document.getElementById("cabtabla13_"+i).hidden=true;
          document.getElementById("cabtabla14_"+i).hidden=true; 
          document.getElementById("cabtabla15_"+i).hidden=true; 
          document.getElementById("cabtabla16_"+i).hidden=true;
          document.getElementById("cabtabla17_"+i).hidden=true;
          document.getElementById("cabtabla18_"+i).hidden=true;


          let itemagregadocant=document.getElementById("itemagregadocant").value
          let cantitem=itemagregadocant.split(',')
          for (j=0;j<cantitem.length-1;j++){
            document.getElementById("edicionremito_"+i+"_"+j).hidden=true;    
          }
             }

      function agregarentrega() {  
       
        let entrega = document.getElementById("entrega").value;
        if (entrega == "") { entrega = entrega + ",,0,,,,,,,''" + + ",,,,,," }
        else {
          entrega = entrega + ";,0,,,,,,,," + + ",,,,,,"
        }
        document.getElementById("entrega").value =entrega
        actualizarentregatabla()
      }
       function actualizarcantremito(x){
        
        let cantentrega=document.getElementById("entregacant").value 
        for (i = 0; i < cantentrega; i++) {
          let itemagregadocant=document.getElementById("itemagregadocant").value
          let cantitem=itemagregadocant.split(',')
         
          arremito=arr[5].split("$_%")
        
          text=""

        for (j=0;j<cantitem.length-1;j++){
        cantitemremito=document.getElementById('entregaremitocant_'+i+'-'+j).value
        let cant=document.getElementById("aa"+j).value
        let unidad=document.getElementById("aau"+j).innerHTML
        let id=document.getElementById("aaaid"+j).innerHTML
        let hijo=document.getElementById("aaahijo"+j).innerHTML
     
   
        let observacion=document.getElementById("aaanombre"+j).innerHTML
        let nombre=document.getElementById("aaaobservacion"+j).innerHTML
       
        
        let visible=document.getElementById("entregaremitovisible_"+i+"-"+j).checked
        let cantreemp=document.getElementById("entregaremitocantreemp_"+i+"-"+j).value
        let texto=document.getElementById("entregaremitotexto_"+i+"-"+j).value
      
        if (cantitemremito!=0){

        if(text==""){
          text = cantitemremito+'*-*'+unidad+"*-*"+id +"*-*"+hijo+"*-*"+nombre+"*-*"+observacion+"*-*"+visible+"*-*"+cantreemp+"*-*"+texto
           }else{
          text = text +'$_%'+cantitemremito+'*-*'+unidad+"*-*"+id +"*-*"+hijo+"*-*"+nombre+"*-*"+observacion+"*-*"+visible+"*-*"+cantreemp+"*-*"+texto
          }
          }}
         
          document.getElementById("entregaitemsremito_"+i).value=text
          }
         actualizarentrega(x) 
          }    
            
      function actualizarentregatabla(x) {  
       
        let entrega = document.getElementById("entrega").value;
        let text = ""
        let text1 = ""
         let text_solovista = ""
        let text1_solovista = ""
        let monto1 = 0 
        porc1 = ""
        let color = ""
        let arrentrega = String(entrega).split(';');
        document.getElementById("entregacant").value = arrentrega.length
        idnv=document.getElementById("idnv").innerHTML
        

        let permiso=document.getElementById('tipousuario').value
        for (i = 0; i < arrentrega.length; i++) {
          
          let arr = String(arrentrega[i]).split(',');   
          text1=""
          text1_solovista=""
          if((permiso=='SIS')||(permiso=='ING')||(permiso=='VEN')||(permiso=='ADM')){
          text1 = text1 + '<td> <input size="40" id="entregatitulo_' + i + '" type="text" value="' + arr[0] + '" onchange="actualizarentrega(' + i + ') ">'
          text1 = text1 + '<td> <input disabled id="entregaremitoelectronico_' + i + '"type="text" value="R' +idnv +'-'+i + '"  >'
          text1 = text1 + '<td> <input id="entregaremito_' + i + '"type="text" value="' + arr[1] + '" onchange="actualizarentrega(' + i + ') ">'
          text1 = text1 + '<td> <input id="entregaporcentaje_' + i + '" type="number" step="0.001" min"0" value="' + arr[2] + '" onchange="actualizarentrega(' + i + ') ">'
          text1 = text1 + '<td> <input id="entregafecha_' + i + '" type="text" value="' + arr[3] + '" onchange="actualizarentrega(' + i + ')">'
          text1 = text1 + '<td> <input id="entregaobservacion_' + i + '" type="text" value="' + arr[4] + '"onchange="actualizarentrega(' + i + ') ">' 
          text1 = text1 + '<td hidden > <input id="entregaitemsremito_' + i + '" type="text" value="' + arr[5] + '"">'
          text1 = text1 + '<td id="btneditremito_'+i+'"> <buttom onclick="editarentrega(' + i + ')"> <i class="bi bi-pencil"></i> </buttom></td> '  
          text1 = text1 + '<td hidden id="btnofineditremito_'+i+'" > <buttom onclick="cerrarentrega(' + i + ')"> <i class="bi bi-arrow-up-square-fill"></i> </buttom></td>'   
          
         
          }else{
          text1 = text1 + '<td> <input disabled size="40"  type="text" value="' + arr[0] + '" onchange="actualizarentrega(' + i + ') ">'
          text1 = text1 + '<td> <input disabled type="text" value="R' +idnv +'-'+i + '" onchange="actualizarentrega(' + i + ') ">'
          text1 = text1 + '<td> <input disabled type="text" value="' + arr[1] + '" onchange="actualizarentrega(' + i + ') ">'
          text1 = text1 + '<td> <input disabled  type="number" step="0.001" min"0" value="' + arr[2] + '" onchange="actualizarentrega(' + i + ') ">'
          text1 = text1 + '<td> <input disabled  type="text" value="' + arr[3] + '" onchange="actualizarentrega(' + i + ')">'
          text1 = text1 + '<td> <input disabled  type="text" value="' + arr[4] + '"onchange="actualizarentrega(' + i + ') ">' 
          text1 = text1 + '<td hidden > <input  type="text" value="' + arr[5] + '"">'
          
          }
          if(permiso=='SIS'){
            text1 = text1 + '<td> <buttom  onclick="eliminarentrega(' + i + ')"> <i class="bi bi-trash"></i> </buttom></td>'
          }
          
          text1 = text1 + '<td id="archivo_'+i+'">------</td> </tr>'
          text1=text1+'<tr hidden id="cabtabla7_' + i + '" > <td colspan="5"> <label>Empresa : </label><select id="diropdestino" > <option value="----------">----------</option> <option value="rs">Razon social</option> <option value="nf">Nombre Fantasía</option>  </select>'
          text1=text1+ ' <input size="50" id="d1_' + i + '" type="text" value="'+arr[6]+'"  onchange="actualizarentrega(' + i + ')"> </td> </tr>'
          text1=text1+' <tr  hidden id="cabtabla8_' + i + '"><td colspan="5"> <label>Dirección : </label> <select id="diropdestino" > <option value="----------">----------</option> <option value="administracion">Dir.Administración</option> <option value="planta">Dir.Planta</option>  </select>'
          text1=text1+ ' <input size="50" id="d2_' + i + '" type="text" value="'+arr[7]+'" onchange="actualizarentrega(' + i + ')"> </td> </tr>'
          text1=text1+' <tr  hidden id="cabtabla9_' + i + '"><td colspan="3"> <label>At. Sr/a : </label> '
          text1=text1+ ' <input size="50" id="d3_' + i + '" type="text" value="'+arr[8]+'" onchange="actualizarentrega(' + i + ')"> </td>'
          text1=text1+' <td colspan="2"> <label>Telefono : </label> '
          text1=text1+ '<input size="30" id="d4_' + i + '" type="text" value="'+arr[9]+'" onchange="actualizarentrega(' + i + ')"> </td> </tr>'
          text1=text1+' <tr  hidden id="cabtabla11_' + i + '"><td colspan="5"> <label>Retiro Cliente de planta EC-Ing. (Quién Retiró?)</label> '
          text1=text1+ ' <input size="50" id="d5_' + i + '" type="text" value="'+arr[10]+'" onchange="actualizarentrega(' + i + ')"> </td> </tr>'
          text1=text1+' <tr  hidden id="cabtabla12_' + i + '"><td colspan="5"> <label>Se entregó en planta del cliente. (Quien transportó?)</label>'
          text1=text1+ ' <input size="50" id="d6_' + i + '" type="text" value="'+arr[11]+'" onchange="actualizarentrega(' + i + ')"> </td> </tr>'
          text1=text1+' <tr  hidden id="cabtabla13_' + i + '"><td colspan="5"> <label>Retiro Transporte de planta EC-Ing. (Qué transporte?)</label> '
          text1=text1+ ' <input size="50" id="d7_' + i + '" type="text" value="'+arr[12]+'" onchange="actualizarentrega(' + i + ')"> </td> </tr>'
          text1=text1+' <tr  hidden id="cabtabla14_' + i + '"><td colspan="5"> <label>Se entregó en Depósito de Transporte. (Qué transporte?)</label>'
          text1=text1+ ' <input size="50" id="d8_' + i + '" type="text" value="'+arr[13]+'" onchange="actualizarentrega(' + i + ')"> </td> </tr>'

          text1=text1+'<tr  hidden id="cabtabla15_' + i + '"> <td colspan="5" > <label>Con redespacho a: (Lugar/Ciudad)</label>'
          text1=text1+ ' <input size="50" id="d9_' + i + '" type="text" value="'+arr[14]+'" onchange="actualizarentrega(' + i + ')"> </td> </tr>'
          
          text1=text1+'<tr  hidden id="cabtabla16_' + i + '"> <td colspan="5" > <label>Lugar de entrega: (Depósito/Entr.Domicilio)</label>'
          text1=text1+ ' <input size="50" id="d10_' + i + '" type="text" value="'+arr[15]+'" onchange="actualizarentrega(' + i + ')"> </td> </tr>'

          text1=text1+'<tr  hidden id="cabtabla17_' + i + '"> <td colspan="5"> <label>Nota:</label> </td> </tr>'
          text1=text1+ ' <tr  hidden id="cabtabla18_' + i + '"> <td colspan="5"> <input size="50" onchange="actualizarentrega()" id="d11_' + i + '" value="' +arr[16]+'">  </td> </tr>'
          text1 = text1 +' <tr  > <td hidden id="cabtabla1_' + i + '" colspan="5" > DATOS COMPUTO DE ENTREGA </td><td hidden id="cabtabla2_' + i + '" colspan="4"> REEMPLAZO DATOS PARA REMITO </td></tr>'
          text1 = text1 +' <tr > <td hidden id="cabtabla3_' + i + '">Visible | Cantidad</td> <td hidden id="cabtabla4_' + i + '" colspan="3">Detalle</td><td hidden id="cabtabla5_' + i + '">Cant</td><td hidden id="cabtabla6_' + i + '" colspan="4">Detalle</td> </tr>'  
         
         
          let itemagregadocant=document.getElementById("itemagregadocant").value
          let cantitem=itemagregadocant.split(',')   
       
          arremito=arr[5].split("$_%")
      
       
          
         for (j=0;j<cantitem.length-1;j++){
    
          let crem=0
          let ct=0
          let text=""
          let chk=true
            let cant=document.getElementById("aa"+j).value  
            let unidad=document.getElementById("aau"+j).innerHTML
            let id=document.getElementById("aaaid"+j).innerHTML
            let hijo=document.getElementById("aaahijo"+j).innerHTML
            let observacion=document.getElementById("aaanombre"+j).innerHTML
            let nombre=document.getElementById("aaaobservacion"+j).innerHTML
           
            
            for (k=0;k<arremito.length;k++){
            aritemremito=arremito[k].split("*-*")
            
            if ((id==aritemremito[2])&&(hijo==aritemremito[3])){
              crem=parseFloat(aritemremito[0])
              if(aritemremito[7]==undefined){aritemremito[7]=0}
            ct=aritemremito[7]
              if(aritemremito[8]==undefined){aritemremito[8]=''}
              text=aritemremito[8]
              if(aritemremito[6]=='false'){ chk=''}else{chk='checked'}
             
            }
            }
        
              if(aritemremito[7]==undefined){aritemremito[7]=0}
              if(aritemremito[8]==undefined){aritemremito[8]=''}
              text1 = text1 +'<tr hidden id="edicionremito_'+i+'_'+j+'"> '       
              text1 = text1 +'<td> <input '+chk+' id="entregaremitovisible_' + i +'-'+j+ '" type="checkbox"  onchange="actualizarcantremito('+i+') "> '
              text1 = text1 +'<input  size="5" id="entregaremitocant_' + i +'-'+j+ '" type="number" min="-1000" step="0.01" value="' + crem + '" onchange="actualizarcantremito('+i+') "> </td>'
              text1 = text1 +'<td colspan="4">'+cant+'-'+unidad+"-"+id +"-"+hijo+"-"+nombre+"-"+observacion+'</td>'
              text1 = text1 +'<td> <input  size="5" id="entregaremitocantreemp_' + i +'-'+j+ '"type="text" value="' + ct + '" onchange="actualizarcantremito('+i+') "> '
              text1 = text1 +'<td colspan="3"><textarea  rows="3" cols="80" id="entregaremitotexto_'+i +'-'+j+'" onchange="actualizarcantremito('+i+') ">'+text+' </textarea></td>'
              text1 = text1 +'<td id="remito_" hidden>'
              text1 = text1 +'</tr>' 
          }
          text1 = text1 +'<tr> <td colspan="5">'
            if (arr[6]!=""){text1=text1+ '<h6> <u>EMPRESA:</u> '+arr[6]+'</h6>'}
            if (arr[7]!=""){text1=text1+ '<h6><u>DIRECCION:</u> '+arr[7]+'</h6>'}
            if (arr[8]!=""){text1=text1+ '<h6><u>CONTACTO:</u> '+arr[8]+' -  <u>Tel.:</u>'+arr[9]+'</h6>' }
          
          if (arr[10]!=""){text1=text1+ '<h6><u>Retiró Cliente de planta EC-Ing.:</u> ('+arr[10]+')</h6>'}
          if (arr[11]!=""){text1=text1+ '<h6><u>Se llevó hasta la planta del Cliente.:</u> ('+arr[11]+')</h6>'}
          if (arr[12]!=""){text1=text1+ '<h6><u>Retiro Transporte de planta EC-Ing.:</u> ('+arr[12]+')</h6>'}
          if (arr[13]!=""){text1=text1+ '<h6><u>Se entregó en Depósito de Transporte. :</u> ('+arr[13]+')</h6>'}
          if (arr[14]!=""){text1=text1+ '<h6><u>Con redespacho a:</u> ('+arr[14]+')</h6>'}
          if (arr[15]!=""){text1=text1+ '<h6><u>Lugar de entrega:</u> ('+arr[15]+')</h6>'}
          if (arr[16]!=""){text1=text1+ '<h6><u>Nota:</u>'+arr[16]+' </h6>  '}

          arremito=arr[5].split("$_%") 

          for (j=0;j<arremito.length;j++){
            console.log("remito-"+j)
          aritemremito=arremito[j].split("*-*")
         
          if(true ){

            text1=text1+'<h6>'
            text1=text1+ '  ' 
              if(aritemremito[7]>0){text1=text1+aritemremito[7]}else{text1=text1+aritemremito[0]+'-'+aritemremito[1]}
              if(aritemremito[7]>0){text1=text1+aritemremito[8]}else{text1=text1+'-'+aritemremito[4]+'-'+aritemremito[5]}
             text1=text1+"-Cod."+aritemremito[2]+'-'+aritemremito[3]+'</h6>'

          }
          } 
          text1 = text1 +'</tr> '
          text = text + text1
          text1_solovista = '<tr> '
          text1_solovista = text1_solovista + '<td> <input disabled  type="text" value="' + arr[0] + '" onchange="actualizarentrega() ">'
          text1_solovista = text1_solovista + '<td> <input disabled type="text" value="' + arr[1] + '" onchange="actualizarentrega() ">'
          text1_solovista = text1_solovista + '<td> <input disabled  type="number" step="0.001" m=in"0" value="' + arr[2] + '" onchange="actualizarentrega() ">'
          text1_solovista = text1_solovista + '<td> <input disabled  type="text" value="' + arr[3] + '" onchange="actualizarentrega()">'
          text1_solovista = text1_solovista + '<td> <input disabled  type="text" value="' + arr[4] + '"onchange="actualizarentrega() ">'
          text1 = text1 + '<td> <buttom onclick="eliminarentrega(' + i + ')"> <i class="bi bi-trash"></i> </buttom></td></tr>'
          text_solovista = text_solovista + text1_solovista
          monto1 = monto1 + parseFloat(arr[2]) 
         
        }

        if (monto1 == 100) {
          porc1 = "COMPLETA"
          color1 = "background-color:greenyellow;"
        }
        else {
          porc1 = "INCOMPLETA"
          color1 = "background-color:tomato;"
        }
       
        text = text + ' <tr ><td></td><td>  </td><td>   <div id="entregares1">' + monto1 + '</div>  </td><td >' + porc1 + '   </td> <tr>'
        text_solovista = text_solovista + ' <tr ><td>  </td><td>  </td><td   ><div id="entregares1_solovista">' + monto1 + '</div>  </td><td >' + porc1 + '   </td> <tr>'
        document.getElementById("entregatabla").innerHTML = text
        document.getElementById("entregatabla_solovista").innerHTML = text_solovista
        document.getElementById("entregares1").style = color1     
        document.getElementById("entregares1_solovista").style = color1
        let resumen=document.getElementById("string08").value
        arrresumen=resumen.split(",")
        for(i=0;i<6;i++){
          if (arrresumen[i]==undefined){arrresumen[i]=0}
        }
      
        resumen=arrresumen[0]+","+arrresumen[1]+","+arrresumen[2]+","+monto1+","+arrresumen[4]+","+arrresumen[5]
        document.getElementById("string08").value=resumen
        if(x!=undefined){editarentrega(x) }
      }

      function actualizarentrega(x) {
        let text = ""
        let cant = document.getElementById("entregacant").value
        for (let i = 0; i < cant; i++) {   
          if (i != 0) { text = text + ";" }
          let a = document.getElementById("entregatitulo_" + i).value
          let b = document.getElementById("entregaremito_" + i).value
          let c = document.getElementById("entregaporcentaje_" + i).value
          let d = document.getElementById("entregafecha_" + i).value
          let e = document.getElementById("entregaobservacion_" + i).value
          let f= document.getElementById("entregaitemsremito_" + i).value
          let d1= document.getElementById("d1_" + i).value
          let d2= document.getElementById("d2_" + i).value
          let d3= document.getElementById("d3_" + i).value
          let d4= document.getElementById("d4_" + i).value
          let d5= document.getElementById("d5_" + i).value
          let d6= document.getElementById("d6_" + i).value
          let d7= document.getElementById("d7_" + i).value
          let d8= document.getElementById("d8_" + i).value
          let d9= document.getElementById("d9_" + i).value
          let d10= document.getElementById("d10_" + i).value
          let d11= document.getElementById("d11_" + i).value
          text = text + a + "," + b + "," + c + "," + d + "," + e + "," + f + "," + d1+ "," + d2+ "," + d3+ "," + d4+ "," + d5+ "," + d6+ "," + d7+ "," + d8+ "," + d9+ "," + d10+ "," + d11 + ",,,,,"
        }
        document.getElementById("entrega").value = text
        actualizarentregatabla(x)
      }
      function eliminarentrega(a) {
        let borrararchivo = confirm("¿Desea eliminar registro de entrega?");
        let text = ""
        let text1 = ""
        let cant = document.getElementById("entregacant").value
      

        if (cant == 1) { text = ",,0,,,,,,,,,,,,,,,,,,," }
        else {
          ii = 0
          for (i = 0; i < cant; i++) {
            if (i != a) {
              if (ii != 0) { text = text + ";" }
              let a = document.getElementById("entregatitulo_" + i).value
              let b = document.getElementById("entregaremito_" + i).value
              let c = document.getElementById("entregaporcentaje_" + i).value
              let d = document.getElementById("entregafecha_" + i).value
              let e = document.getElementById("entregaobservacion_" + i).value
              let f= document.getElementById("entregaitemsremito_" + i).value
              let d1= document.getElementById("d1_" + i).value
          let d2= document.getElementById("d2_" + i).value
          let d3= document.getElementById("d3_" + i).value
          let d4= document.getElementById("d4_" + i).value
          let d5= document.getElementById("d5_" + i).value
          let d6= document.getElementById("d6_" + i).value
          let d7= document.getElementById("d7_" + i).value
          let d8= document.getElementById("d8_" + i).value
          let d9= document.getElementById("d9_" + i).value
          let d10= document.getElementById("d10_" + i).value
          let d11= document.getElementById("d11_" + i).innerHTML
          text = text + a + "," + b + "," + c + "," + d + "," + e + "," + f + "," + d1+ "," + d2+ "," + d3+ "," + d4+ "," + d5+ "," + d6+ "," + d7+ "," + d8+ "," + d9+ "," + d10+ "," + d11 + ",,,,,"
     
              ii++
            }
          }
        }

        document.getElementById("entrega").value = text
        actualizarentregatabla()

      }

      //////////////////////////////////////////////////////
      //LINK BUTTON ///////////////////////////////////////
      //LINK BUTTON ///////////////////////////////////////
      //LINK BUTTON ///////////////////////////////////////
      //////////////////////////////////////////////////////

      function updatelink() {
        let link = document.getElementById("string01").value;
        link
        document.getElementById("linkbutton").href = link
      
      }

      window.onbeforeunload = function () {
        var scrollPos;
        if (typeof window.pageYOffset != 'undefined') {
          scrollPos = window.pageYOffset;
        }
        else if (typeof document.compatMode != 'undefined' && document.compatMode != 'BackCompat') {
          scrollPos = document.documentElement.scrollTop;
        }
        else if (typeof document.body != 'undefined') {
          scrollPos = document.body.scrollTop;
        }
        document.cookie = "scrollTop=" + scrollPos + "URL=" + window.location.href;
      }


      function stopDefault(event) {
        event.preventDefault();
        event.stopPropagation();
      }
      function dragOver(label, text) {
        /* ADD ALMOST ANY STYLING YOU LIKE */
        label.style.animationName = "dropbox";
        label.innerText = text;
      }
      function dragLeave(label) {
        /* THIS SHOULD REMOVE ALL STYLING BY dragOver() */
        var len = label.style.length;
        for (var i = 0; i < len; i++) {
          label.style[label.style[i]] = "";
        }
        label.innerText = "Arrastre archivos aqui o presione para seleccionar";
      }
      function addFilesAndSubmit(event) {
        var files = event.target.files || event.dataTransfer.files;
        document.getElementById("filesfld").files = files;
        submitFilesForm(document.getElementById("filesfrm"));
      }
      function submitFilesForm(form) {
        var label = document.getElementById("fileslbl");
        dragOver(label, "Subiendo archivos..."); // set the drop zone text and styling
        var fd = new FormData();
        for (var i = 0; i < form.filesfld.files.length; i++) {
          var field = form.filesfld;
          fd.append(field.name, field.files[i], field.files[i].name);
        }
        var progress = document.getElementById("progress");
        var x = new XMLHttpRequest();
        if (x.upload) {
          x.upload.addEventListener("progress", function (event) {
            var percentage = parseInt(event.loaded / event.total * 100);
            progress.innerText = progress.style.width = "Progreso: " + percentage + "%";
          });
        }
        x.onreadystatechange = function () {
          if (x.readyState == 4) {
            progress.innerText = progress.style.width = "";
            form.filesfld.value = "";
            dragLeave(label); // this will reset the text and styling of the drop zone
            if (x.status == 200) {
              var images = JSON.parse(x.responseText);
          
              let imagescant = String(images).split(',');
              let strcant = "";
              let descr = "";
              document.getElementById("archivos-cant").value = imagescant.length
              for (let i = 0; i < imagescant.length; i++) {
                if (i == 0) { strcant = "true"; descr = "S/D" }
                else {
                  strcant = strcant + ",true"; descr = descr + ",S/D"
                }
              }

              var archivos = document.getElementById("archivos-0").value;
              if (archivos == "") { archivos = images; }
              else {
                archivos = archivos + "," + images;
              }
              let files = archivos
              document.getElementById("archivos-0").value = archivos

              archivos = document.getElementById("archivos-1").value;
              if (archivos == "") { archivos = descr; }
              else {
                archivos = archivos + "," + descr;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-1").value = archivos

              archivos = document.getElementById("archivos-2").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-2").value = archivos

              archivos = document.getElementById("archivos-3").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-3").value = archivos

              archivos = document.getElementById("archivos-4").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-4").value = archivos

              archivos = document.getElementById("archivos-5").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-5").value = archivos

              archivos = document.getElementById("archivos-6").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-6").value = archivos

              archivos = document.getElementById("archivos-7").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-7").value = archivos

              archivos = document.getElementById("archivos-8").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-8").value = archivos

              archivos = document.getElementById("archivos-9").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-9").value = archivos

              archivos = document.getElementById("archivos-10").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-10").value = archivos

              archivos = document.getElementById("archivos-11").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              document.getElementById("archivos-11").value = archivos

              archivos = document.getElementById("archivos-12").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-12").value = archivos

              archivos = document.getElementById("archivos-13").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-13").value = archivos

              archivos = document.getElementById("archivos-14").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-14").value = archivos

              archivos = document.getElementById("archivos-15").value;
              if (archivos == "") { archivos = strcant; }
              else {
                archivos = archivos + "," + strcant;
              }
              files = files + ";" + archivos
              document.getElementById("archivos-15").value = archivos

              files = files + ";" + archivos
              document.getElementById("files_upload").value = files
             



              for (var i = 0; i < images.length; i++) {
                var img = document.createElement("img");
                img.src = images[i];
                document.body.appendChild(img);
              }
            }
            else {
              // failed - TODO: Add code to handle server errors
            }
          }
          actualizararchivos();
        };

        x.open("post", form.action, true);
        x.send(fd);
        return false;
      }
    </script>

    <script>
      //actualizararchivos();
      // let temp = document.getElementById('unidad').value;
      // let mySelect = document.getElementById('unidadSelect');
     
      // for (var i, j = 0; i = mySelect.options[j]; j++) {
      //   if (i.text == temp) {
      //     mySelect.selectedIndex = j;
      //     break;
      //   }
      // }

      function updateFiles() {
    
        let text = ""
        let cant = document.getElementById("archivos-cant").value
        let texto = document.getElementById("archivos-0").value;
        for (j = 1; j < 16; j++) {
          for (i = 0; i < cant; i++) {
            console.log('file' + j + '_' + i)
            if (j == 1) {
           
              if (i == 0) {
                text = document.getElementById('file' + j + '_' + i).value;
              } else {
                text = text + "," + document.getElementById('file' + j + '_' + i).value;
              }
            }
            if (j > 1) {
           
              if (i == 0) {
                text = document.getElementById('file' + j + '_' + i).checked;
                //text = 'true'
              }
              else {
                text = text + "," + document.getElementById('file' + j + '_' + i).checked;
                //text = text + "," +'true'
              }
            }

          }

          texto = texto + ";" + text
          text = ""
      
        }
 
        document.getElementById("files_upload").value = texto
      }

      function actualizararchivos() {
        let archivo = document.getElementById("files_upload").value;
      
        if (archivo == "") {
       
          document.getElementById("archivos-cant").value = 0
          document.getElementById("archivos-0").value = ""
          document.getElementById("archivos-1").value = ""
          document.getElementById("archivos-2").value = ""
          document.getElementById("archivos-3").value = ""
          document.getElementById("archivos-4").value = ""
          document.getElementById("archivos-5").value = ""
          document.getElementById("archivos-6").value = ""
          document.getElementById("archivos-7").value = ""
          document.getElementById("archivos-8").value = ""
          document.getElementById("archivos-9").value = ""
          document.getElementById("archivos-10").value = ""
          document.getElementById("archivos-11").value = ""
          document.getElementById("archivos-12").value = ""
          document.getElementById("archivos-13").value = ""
          document.getElementById("archivos-14").value = ""
          document.getElementById("archivos-15").value = ""

        }
        else {
          let archivos = String(archivo).split(';');
          document.getElementById("archivos-0").value = archivos[0]
          document.getElementById("archivos-1").value = archivos[1]
          document.getElementById("archivos-2").value = archivos[2]
          document.getElementById("archivos-3").value = archivos[3]
          document.getElementById("archivos-4").value = archivos[4]
          document.getElementById("archivos-5").value = archivos[5]
          document.getElementById("archivos-6").value = archivos[6]
          document.getElementById("archivos-7").value = archivos[7]
          document.getElementById("archivos-8").value = archivos[8]
          document.getElementById("archivos-9").value = archivos[9]
          document.getElementById("archivos-10").value = archivos[10]
          document.getElementById("archivos-11").value = archivos[11]
          document.getElementById("archivos-12").value = archivos[12]
          document.getElementById("archivos-13").value = archivos[13]
          document.getElementById("archivos-14").value = archivos[14]
          document.getElementById("archivos-15").value = archivos[14]
          let cantdatos = String(archivos[0]).split(',');
          document.getElementById("archivos-cant").value = cantdatos.length
          var d = new Array(archivos.length);
          for (var i = 0; i < archivos.length; i++) {
            d[i] = new Array(cantdatos.length);
          }
          let permiso=""
          let p=document.getElementById("tipousuario").value
          if(p=='ING'){  permiso = String(archivos[15]).split(',');}
          if(p=='VEN'){  permiso = String(archivos[14]).split(',');}
          if(p=='ADM'){  permiso = String(archivos[13]).split(',');}
          if(p=='SIS'){  permiso = String(archivos[14]).split(',');}

          for (let i = 0; i < archivos.length; i++) {
            let datos = String(archivos[i]).split(',');
            for (let j = 0; j < cantdatos.length; j++) {
              if(permiso[j]=="true"){permitido=true}else{permitido=false}
              if(p=='SIS'){permitido=true}

              console.log('datos[14] '+p,i,j,permitido)
              if (i == 0) {
                datosaux = String(datos[j]).split('_$_');
                if(permitido){
                datos[j] = '<a id="file' + i + '_' + j + '" href="/upload_files/_$$_' + datos[j] + '">' + datosaux[1] + '</a>'
                }else{
                  datos[j] = '<a id="file' + i + '_' + j + '" href="">' + datosaux[1] + '</a>' 
                }
                //datos[j] = '<a id="file' + i + '_' + j + '" href="/upload_files/_$$_' + datos[j] + '">' + datosaux[1] + '</a>'
                let auxx=datosaux[1].split('-')
                console.log('auxx '+auxx+'-'+auxx.length)
                let nv=document.getElementById("idnv").innerHTML
              
                if(auxx.length>1){

               
                  let auxx1=auxx[1].split('.')
                  auxx2=parseInt( auxx1[0]) 
                  console.log('auxx2 '+auxx2+"-"+auxx[1]+' auxx[0] '+auxx[0])
                
                
                if(auxx[0]==('R'+nv)){      
                  if(document.getElementById("archivo_"+auxx2)){
                  
                    document.getElementById("archivo_"+auxx2).innerHTML=datos[j]
                  }
                  if((document.getElementById("tipousuario").value!='SIS')&&(document.getElementById("entregatitulo_"+auxx2))){  
                    console.log('aaaa--auxx2 '+auxx2+"-"+auxx[1]+' auxx[0] '+auxx[0])
                    document.getElementById("entregatitulo_"+auxx2).disabled=true
                    document.getElementById("entregaremitoelectronico_"+auxx2).disabled=true
                    document.getElementById("entregaremito_"+auxx2).disabled=true
                    document.getElementById("entregaporcentaje_"+auxx2).disabled=true
                    document.getElementById("entregafecha_"+auxx2).disabled=true
                    document.getElementById("entregaobservacion_"+auxx2).disabled=true
                    document.getElementById("btnofineditremito_"+auxx2).hidden=true
                    document.getElementById("btneditremito_"+auxx2).hidden=true 
                  }
                }


                if(auxx[0]==('F'+nv)){      
                  if(document.getElementById("archivofactura_"+auxx2)){
                   
                    document.getElementById("archivofactura_"+auxx2).innerHTML=datos[j]
                    document.getElementById("archivofacturasolovista_"+auxx2).innerHTML=datos[j]
                  }

                  // if(document.getElementById('archivofactura_"+auxx2') ){
                  //   document.getElementById("archivofacturasolovista_"+auxx2).innerHTML=datos[j]
                  // document.getElementById("archivofactura_"+auxx2).innerHTML=datos[j]
                  // }
                  // if(document.getElementById("tipousuario").value!='SIS'){   
                  //   document.getElementById("entregatitulo_"+auxx2).disabled=true
                  //   document.getElementById("entregaremitoelectronico_"+auxx2).disabled=true
                  //   document.getElementById("entregaremito_"+auxx2).disabled=true
                  //   document.getElementById("entregaporcentaje_"+auxx2).disabled=true
                  //   document.getElementById("entregafecha_"+auxx2).disabled=true
                  //   document.getElementById("entregaobservacion_"+auxx2).disabled=true
                  //   document.getElementById("btnofineditremito_"+auxx2).hidden=true
                  //   document.getElementById("btneditremito_"+auxx2).hidden=true 
                  // }
                }

                if(auxx[0]==('C'+nv)){      
                  if(document.getElementById("archivocobro_"+auxx2)){
                   
                    document.getElementById("archivocobro_"+auxx2).innerHTML=datos[j]
                    document.getElementById("archivocobrosolovista_"+auxx2).innerHTML=datos[j]
                  }
                  // if(document.getElementById("tipousuario").value!='SIS'){   
                  //   document.getElementById("entregatitulo_"+auxx2).disabled=true
                  //   document.getElementById("entregaremitoelectronico_"+auxx2).disabled=true
                  //   document.getElementById("entregaremito_"+auxx2).disabled=true
                  //   document.getElementById("entregaporcentaje_"+auxx2).disabled=true
                  //   document.getElementById("entregafecha_"+auxx2).disabled=true
                  //   document.getElementById("entregaobservacion_"+auxx2).disabled=true
                  //   document.getElementById("btnofineditremito_"+auxx2).hidden=true
                  //   document.getElementById("btneditremito_"+auxx2).hidden=true 
                  // }
                }

              }







              }

              if (i == 1) {
                if(permitido){
                  datos[j] = '<input id="file' + i + '_' + j + '" type="text" value="' + datos[j] + '" onchange="updateFiles(' + i + ',' + j + ') ">'
                }else{
                  datos[j] = '<input disabled id="file' + i + '_' + j + '" type="text" value="' + datos[j] + '" onchange="updateFiles(' + i + ',' + j + ') ">'
                }
                }

              if (i > 1) {
                if(permitido){
                  if (datos[j] == "false") {
                  datos[j] = '<input id="file' + i + '_' + j + '"  type="checkbox" onchange="updateFiles(' + i + ',' + j + ') " >'
                }
                else {
                  datos[j] = '<input id="file' + i + '_' + j + '"  type="checkbox" onchange="updateFiles(' + i + ',' + j + ') " checked>'
                }
                }else{
                  if (datos[j] == "false") {
                  datos[j] = '<input disabled id="file' + i + '_' + j + '"  type="checkbox" onchange="updateFiles(' + i + ',' + j + ') " >'
                }
                else {
                  datos[j] = '<input disabled id="file' + i + '_' + j + '"  type="checkbox" onchange="updateFiles(' + i + ',' + j + ') " checked>'
                }
                }
              }

              d[i][j] = datos[j]
            }
          }
        
          var textaction = ""
          var text = ""
          var text1 = ""
          for (let j = 0; j < cantdatos.length; j++) {
            for (let i = 0; i < archivos.length; i++) {
              text = text + "<td class=' text-secondary text-xs font-weight-bolder text-black-100 col-1'>" + d[i][j] + "</td>  "
            }
            if(document.getElementById("tipousuario").value=='SIS'){
            textaction = "<td class=' text-secondary text-xs font-weight-bolder text-black-100 col-1'>  <a type='btn btn-info boton-color' onclick=' deleteFiles(" + j + ")'> <i class='bi bi-trash'> </i> </a> </td> "
            } else{ }
           
            text1 = text1 + "<tr>" + text + textaction + "</tr>"
            text = ""
          
        }
        
        }
        document.getElementById("archivoslista").innerHTML = text1
      }

      function deleteFiles(jj) {
      
        let borrararchivo = confirm("¿Desea eliminar archivo?");
        if (borrararchivo) {
     
          var text = ""
          var text1 = ""
          var archivo = document.getElementById("files_upload").value;
          var archivoColumnas = String(archivo).split(';');
      
          for (i = 0; i < archivoColumnas.length; i++) {
        
            var archivos = String(archivoColumnas[i]).split(',');
          

            for (j = 0; j < archivos.length; j++) {
           

              if (j == jj) { }
              else {
             
                if (text == "") { text = archivos[j] }
                else { text = text + "," + archivos[j] }

              }
            }
            if (text1 == "") { text1 = text }
            else {
              text1 = text1 + ";" + text
            }
            text = ""
          }
        
          document.getElementById("files_upload").value = text1
          actualizararchivos()
        }
    
      }

      function actualizarindicator() {
        let cantitemstrig = "0"
        let costo = 0
        let cant = document.getElementById("indicatortotal").value;
      
        for (let i = 0; i < cant; i++) {
          let a = parseFloat(document.getElementById("bb" + i).value);
          let b = parseFloat(document.getElementById("cc" + i).innerHTML);
         
          cantitemstrig = cantitemstrig + "," + a
          costo = costo + (a * b)
        }
        document.getElementById('costopropio').value = costo

        let costoitemagregados = parseFloat(document.getElementById('costoitemsagregados').value)
        costo = costo + costoitemagregados

        document.getElementById('costoarbol').value = costo

      
        document.getElementById('indicatoragregadocant').value = cantitemstrig
      }

      function cambiarestadoitem(j){ 
       
           let cant = document.getElementById("itemtotal").value;

       
        
          let g = document.getElementById("ag" + j).value
          if(g=="Aprobado"){
          document.getElementById("aq" + j).value=document.getElementById("short" ).value
          document.getElementById("ar" + j).value=document.getElementById("fecha" ).value
          }else{
            document.getElementById("aq" + j).value=""
          document.getElementById("ar" + j).value=""
          
      }
      actualizaritem()
    }

      function actualizaritem() {
        let cantitemstrig = "0"
        let cantitementregadostring="0"
        let motivo = "0"
        let referencia = "0"
        let estado = "0"
        let preciocotizado = "0"
        let texto_a_d_r = "0"
        let costo = 0
        let precio = 0
        let preciocustom = 0
        let usuario="0"
        let fecha="0"
        let cant = document.getElementById("itemtotal").value;
      
        for (let i = 0; i < cant; i++) {
          let a = parseFloat(document.getElementById("aa" + i).value);
          let aentregado = parseFloat(document.getElementById("aaentregado" + i).value);
          let b = parseFloat(document.getElementById("dd" + i).innerHTML);
          let c = parseFloat(document.getElementById("ee" + i).innerHTML);
          let d = parseFloat(document.getElementById("ff" + i).value);
          let m = document.getElementById("am" + i).value;
          let n = document.getElementById("an" + i).value;
          let p = document.getElementById("ap" + i).value;
          let q = document.getElementById("aq" + i).value;
          let r = document.getElementById("ar" + i).value;
          texto_a_d_r = texto_a_d_r + ";" + m + "," + n + "," + p

          let e = document.getElementById("ak" + i).value
          // if ((e != "Normal") && (e != "Desviación") && (e != "Adaptación") && (e != "Retrabajo")) { e = "Normal" }

          let g = document.getElementById("ag" + i).value
          // if ((g != "Edicion") && (g != "Aprobado") && (g != "Anulado")) { g = "Edicion" }
          let f = document.getElementById("al" + i).value;
          preciocotizado = preciocotizado + "," + d
          cantitemstrig = cantitemstrig + "," + a
          cantitementregadostring = cantitementregadostring + ","+aentregado
          costo = costo + (a * b)
          precio = precio + (a * c)
          preciocustom = preciocustom + d
          motivo = motivo + "," + e,
            referencia = referencia + "," + f
            usuario=usuario+ "," + q
            fecha=fecha+ "," + r

          estado = estado + "," + g
          document.getElementById("ddt" + i).innerHTML = a * b;
          document.getElementById("eet" + i).innerHTML = a * c;

        }
   
        document.getElementById("ddtt").innerHTML = parseInt(costo*10)/10 ;
        document.getElementById("eett").innerHTML = parseInt(precio*10)/10 ;
        document.getElementById("fftt").innerHTML = parseInt(preciocustom*10)/10 ;

     
        document.getElementById('itemagregadoestado').value = estado
        document.getElementById('string04').value = motivo
        document.getElementById('string05').value = referencia
        document.getElementById('string06').value = preciocotizado
        document.getElementById('string07').value = texto_a_d_r
        document.getElementById('string10').value = usuario
        document.getElementById('string09').value = fecha
       
        document.getElementById('itemagregadocant').value = cantitemstrig
        document.getElementById('itementregadocant').value = cantitementregadostring
        document.getElementById('costoitemsagregados').value = costo
        let costopropio = parseFloat(document.getElementById('costopropio').value)
        costo = costo + costopropio
        document.getElementById('costoarbol').value = costo
      }

      function ordenaritem() {
     
        let cant = document.getElementById("itemtotal").value;
        let id = document.getElementById("notaventa_id").value;
        let ii = 0
        let aa = 0
        let a = 0
        for (let i = 0; i < cant; i++) {
          a = parseFloat(document.getElementById("ao" + i).value);
     
          if (a != (i + 1)) { ii = i + 1; aa = a }
        }

      
        let _datos = {
          origen: ii,
          destino: aa
        }
      
        let url = '../ordenaritems/' + ii + ',' + aa + ',' + id

        fetch(url, {
          method: "GET",

          headers: { "Content-type": "application/json; charset=UTF-8" }
        })

        setTimeout(function () {
          location.reload()
        }, 500);
      }

      function oprubro() {
        const rubros = document.getElementById("seltipo").value;
        const tipoaux = document.getElementById("seltipo").innerText;
      
        let arr = rubros.split(',');
        let op = ' '
        const a = ' <option name="rubroitem" value="'
        const b = '">'
        const c = '</option>"'
        const list = document.getElementById("oprubros");
        const tipo = document.getElementById("tipoitem");
        for (let i = 1; i < arr.length; i++) {
          op = op + a + arr[i] + b + arr[i] + c
        }
        list.innerHTML = op
        tipo.value = arr[0]
      }
    </script>
    <script>
      actualizaritem()
      actualizarindicator()
      // var ctx = document.getElementById("chart-bars").getContext("2d");
      // new Chart(ctx, {
      //   type: "bar",
      //   data: {
      //     labels: ["Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
      //     datasets: [{
      //       label: "Sales",
      //       tension: 0.4,
      //       borderWidth: 0,
      //       borderRadius: 4,
      //       borderSkipped: false,
      //       backgroundColor: "#fff",
      //       data: [450, 200, 100, 220, 500, 100, 400, 230, 500],
      //       maxBarThickness: 6
      //     },],
      //   },
      //   options: {
      //     responsive: true,
      //     maintainAspectRatio: false,
      //     plugins: {
      //       legend: {
      //         display: false,
      //       }
      //     },
      //     interaction: {
      //       intersect: false,
      //       mode: 'index',
      //     },
      //     scales: {
      //       y: {
      //         grid: {
      //           drawBorder: false,
      //           display: false,
      //           drawOnChartArea: false,
      //           drawTicks: false,
      //         },
      //         ticks: {
      //           suggestedMin: 0,
      //           suggestedMax: 500,
      //           beginAtZero: true,
      //           padding: 15,
      //           font: {
      //             size: 14,
      //             family: "Open Sans",
      //             style: 'normal',
      //             lineHeight: 2
      //           },
      //           color: "#fff"
      //         },
      //       },
      //       x: {
      //         grid: {
      //           drawBorder: false,
      //           display: false,
      //           drawOnChartArea: false,
      //           drawTicks: false
      //         },
      //         ticks: {
      //           display: false
      //         },
      //       },
      //     },
      //   },
      // });


      function mydateinv(i) {
        //alert("");
        document.getElementById("dt" + i).hidden = true;
        document.getElementById("ndt" + i).hidden = true;
        document.getElementById("ndi" + i).hidden = false;
        document.getElementById("ndx" + i).hidden = true;
      }
      function mydate(i) {
        //alert("");
        document.getElementById("dt" + i).hidden = false;
        document.getElementById("ndt" + i).hidden = true;
        document.getElementById("ndi" + i).hidden = true;
        document.getElementById("ndx" + i).hidden = false;
      }
      function mydate1() {
       
        d = new Date(document.getElementById("dt" + i).value);
      
        dt = d.getDate();
        mn = d.getMonth();
        mn++;
        yy = d.getFullYear();
        document.getElementById("ndt" + i).value = dt + "/" + mn + "/" + yy
        document.getElementById("ndi" + i).value = dt + "/" + mn + "/" + yy
        document.getElementById("ndt" + i).hidden = false;
        document.getElementById("dt" + i).hidden = true;
      }


      // var $tableBody = $('#recipeTableBody');
      // var $menu = $('#menu');
      // $(document).on('click', '.recipe-table__add-row-btn', function (e) {
      //   var $el = $(e.currentTarget);
      //   var htmlString = $('#rowTemplate').html();
      //   $tableBody.append(htmlString);
      //   return false;
      // });

      // $tableBody.on('click', '.recipe-table__del-row-btn', function (e) {
      //   var $el = $(e.currentTarget);
      //   var $row = $el.closest('tr');
      //   $row.remove();
      //   return false;
      // });
      // Sortable.create(
      //   $tableBody[0],
      //   {
      //     animation: 150,
      //     scroll: true,
      //     handle: '.drag-handler',
      //     onEnd: function () {
      
      //     }
      //   }
      // );

      var ctx = document.getElementById("chart-bars").getContext("2d");

      new Chart(ctx, {
        type: "bar",
        data: {
          labels: ["Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
          datasets: [{
            label: "Sales",
            tension: 0.4,
            borderWidth: 0,
            borderRadius: 4,
            borderSkipped: false,
            backgroundColor: "#fff",
            data: [450, 200, 100, 220, 500, 100, 400, 230, 500],
            maxBarThickness: 6
          },],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false,
            }
          },
          interaction: {
            intersect: false,
            mode: 'index',
          },
          scales: {
            y: {
              grid: {
                drawBorder: false,
                display: false,
                drawOnChartArea: false,
                drawTicks: false,
              },
              ticks: {
                suggestedMin: 0,
                suggestedMax: 500,
                beginAtZero: true,
                padding: 15,
                font: {
                  size: 14,
                  family: "Open Sans",
                  style: 'normal',
                  lineHeight: 2
                },
                color: "#fff"
              },
            },
            x: {
              grid: {
                drawBorder: false,
                display: false,
                drawOnChartArea: false,
                drawTicks: false
              },
              ticks: {
                display: false
              },
            },
          },
        },
      });


      var ctx2 = document.getElementById("chart-line").getContext("2d");
      var gradientStroke1 = ctx2.createLinearGradient(0, 230, 0, 50);
      gradientStroke1.addColorStop(1, 'rgba(203,12,159,0.2)');
      gradientStroke1.addColorStop(0.2, 'rgba(72,72,176,0.0)');
      gradientStroke1.addColorStop(0, 'rgba(203,12,159,0)'); //purple colors
      var gradientStroke2 = ctx2.createLinearGradient(0, 230, 0, 50);
      gradientStroke2.addColorStop(1, 'rgba(20,23,39,0.2)');
      gradientStroke2.addColorStop(0.2, 'rgba(72,72,176,0.0)');
      gradientStroke2.addColorStop(0, 'rgba(20,23,39,0)'); //purple colors

      new Chart(ctx2, {
        type: "line",
        data: {
          labels: ["Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
          datasets: [{
            label: "Mobile apps",
            tension: 0.4,
            borderWidth: 0,
            pointRadius: 0,
            borderColor: "#cb0c9f",
            borderWidth: 3,
            backgroundColor: gradientStroke1,
            fill: true,
            data: [50, 40, 300, 220, 500, 250, 400, 230, 500],
            maxBarThickness: 6
          },
          {
            label: "Websites",
            tension: 0.4,
            borderWidth: 0,
            pointRadius: 0,
            borderColor: "#3A416F",
            borderWidth: 3,
            backgroundColor: gradientStroke2,
            fill: true,
            data: [30, 90, 40, 140, 290, 290, 340, 230, 400],
            maxBarThickness: 6
          },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false,
            }
          },
          interaction: {
            intersect: false,
            mode: 'index',
          },
          scales: {
            y: {
              grid: {
                drawBorder: false,
                display: true,
                drawOnChartArea: true,
                drawTicks: false,
                borderDash: [5, 5]
              },
              ticks: {
                display: true,
                padding: 10,
                color: '#b2b9bf',
                font: {
                  size: 11,
                  family: "Open Sans",
                  style: 'normal',
                  lineHeight: 2
                },
              }
            },
            x: {
              grid: {
                drawBorder: false,
                display: false,
                drawOnChartArea: false,
                drawTicks: false,
                borderDash: [5, 5]
              },
              ticks: {
                display: true,
                color: '#b2b9bf',
                padding: 20,
                font: {
                  size: 11,
                  family: "Open Sans",
                  style: 'normal',
                  lineHeight: 2
                },
              }
            },
          },
        },
      });
    </script>
    <script>
      var win = navigator.platform.indexOf('Win') > -1;
      if (win && document.querySelector('#sidenav-scrollbar')) {
        var options = {
          damping: '0.5'
        }
        Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
      }
    </script>
    <!-- Github buttons -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Control Center for Soft Dashboard: parallax effects, scripts for the example pages etc -->
    <script src="../js/soft-ui-dashboard.min.js?v=1.0.7"></script>
</body>

</html>